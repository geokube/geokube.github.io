
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="geokube - a Python package based on xarray for Geoscience Data Analysis and Visualization">
      
      
      
      
        <link rel="prev" href="coord_system.html">
      
      
        <link rel="next" href="domain.html">
      
      
      <link rel="icon" href="img/favicon.svg">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.6">
    
    
      
        <title>Feature - geokube</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.50c56a3b.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="amber">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#geokube.core.feature" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="geokube" class="md-header__button md-logo" aria-label="geokube" data-md-component="logo">
      
  <img src="img/favicon.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            geokube
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Feature
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="amber"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/CMCC-Foundation/geokube" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
  </div>
  <div class="md-source__repository">
    CMCC-Foundation/geokube
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="geokube" class="md-nav__button md-logo" aria-label="geokube" data-md-component="logo">
      
  <img src="img/favicon.svg" alt="logo">

    </a>
    geokube
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/CMCC-Foundation/geokube" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
  </div>
  <div class="md-source__repository">
    CMCC-Foundation/geokube
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    geokube
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="axis.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Axis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="crs.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Crs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="coord_system.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Coord system
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Feature
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="feature.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Feature
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#geokube.core.feature" class="md-nav__link">
    <span class="md-ellipsis">
      feature
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geokube.core.feature--feature" class="md-nav__link">
    <span class="md-ellipsis">
      Feature
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geokube.core.feature.Feature" class="md-nav__link">
    <span class="md-ellipsis">
      Feature
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Feature">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.Feature.__eq__" class="md-nav__link">
    <span class="md-ellipsis">
      __eq__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.Feature.__ne__" class="md-nav__link">
    <span class="md-ellipsis">
      __ne__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geokube.core.feature.FeatureMixin" class="md-nav__link">
    <span class="md-ellipsis">
      FeatureMixin
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FeatureMixin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.FeatureMixin.aux_axes" class="md-nav__link">
    <span class="md-ellipsis">
      aux_axes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.FeatureMixin.aux_coords" class="md-nav__link">
    <span class="md-ellipsis">
      aux_coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.FeatureMixin.coord_system" class="md-nav__link">
    <span class="md-ellipsis">
      coord_system
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.FeatureMixin.coords" class="md-nav__link">
    <span class="md-ellipsis">
      coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.FeatureMixin.crs" class="md-nav__link">
    <span class="md-ellipsis">
      crs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.FeatureMixin.dim_axes" class="md-nav__link">
    <span class="md-ellipsis">
      dim_axes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.FeatureMixin.dim_coords" class="md-nav__link">
    <span class="md-ellipsis">
      dim_coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.FeatureMixin.bounding_box" class="md-nav__link">
    <span class="md-ellipsis">
      bounding_box
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.FeatureMixin.isel" class="md-nav__link">
    <span class="md-ellipsis">
      isel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.FeatureMixin.latest" class="md-nav__link">
    <span class="md-ellipsis">
      latest
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.FeatureMixin.nearest_horizontal" class="md-nav__link">
    <span class="md-ellipsis">
      nearest_horizontal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.FeatureMixin.nearest_time" class="md-nav__link">
    <span class="md-ellipsis">
      nearest_time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.FeatureMixin.nearest_vertical" class="md-nav__link">
    <span class="md-ellipsis">
      nearest_vertical
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.FeatureMixin.sel" class="md-nav__link">
    <span class="md-ellipsis">
      sel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.FeatureMixin.time_range" class="md-nav__link">
    <span class="md-ellipsis">
      time_range
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.FeatureMixin.to_netcdf" class="md-nav__link">
    <span class="md-ellipsis">
      to_netcdf
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geokube.core.feature.GridFeature" class="md-nav__link">
    <span class="md-ellipsis">
      GridFeature
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GridFeature">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.GridFeature.as_points" class="md-nav__link">
    <span class="md-ellipsis">
      as_points
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.GridFeature.nearest_horizontal" class="md-nav__link">
    <span class="md-ellipsis">
      nearest_horizontal
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geokube.core.feature.PointsFeature" class="md-nav__link">
    <span class="md-ellipsis">
      PointsFeature
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PointsFeature">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.PointsFeature.number_of_points" class="md-nav__link">
    <span class="md-ellipsis">
      number_of_points
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geokube.core.feature.ProfilesFeature" class="md-nav__link">
    <span class="md-ellipsis">
      ProfilesFeature
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ProfilesFeature">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.ProfilesFeature.number_of_levels" class="md-nav__link">
    <span class="md-ellipsis">
      number_of_levels
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.ProfilesFeature.number_of_profiles" class="md-nav__link">
    <span class="md-ellipsis">
      number_of_profiles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.ProfilesFeature.as_points" class="md-nav__link">
    <span class="md-ellipsis">
      as_points
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.ProfilesFeature.bounding_box" class="md-nav__link">
    <span class="md-ellipsis">
      bounding_box
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.ProfilesFeature.nearest_vertical" class="md-nav__link">
    <span class="md-ellipsis">
      nearest_vertical
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="domain.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Domain
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="field.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Field
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="about.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#geokube.core.feature" class="md-nav__link">
    <span class="md-ellipsis">
      feature
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geokube.core.feature--feature" class="md-nav__link">
    <span class="md-ellipsis">
      Feature
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geokube.core.feature.Feature" class="md-nav__link">
    <span class="md-ellipsis">
      Feature
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Feature">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.Feature.__eq__" class="md-nav__link">
    <span class="md-ellipsis">
      __eq__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.Feature.__ne__" class="md-nav__link">
    <span class="md-ellipsis">
      __ne__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geokube.core.feature.FeatureMixin" class="md-nav__link">
    <span class="md-ellipsis">
      FeatureMixin
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FeatureMixin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.FeatureMixin.aux_axes" class="md-nav__link">
    <span class="md-ellipsis">
      aux_axes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.FeatureMixin.aux_coords" class="md-nav__link">
    <span class="md-ellipsis">
      aux_coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.FeatureMixin.coord_system" class="md-nav__link">
    <span class="md-ellipsis">
      coord_system
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.FeatureMixin.coords" class="md-nav__link">
    <span class="md-ellipsis">
      coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.FeatureMixin.crs" class="md-nav__link">
    <span class="md-ellipsis">
      crs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.FeatureMixin.dim_axes" class="md-nav__link">
    <span class="md-ellipsis">
      dim_axes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.FeatureMixin.dim_coords" class="md-nav__link">
    <span class="md-ellipsis">
      dim_coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.FeatureMixin.bounding_box" class="md-nav__link">
    <span class="md-ellipsis">
      bounding_box
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.FeatureMixin.isel" class="md-nav__link">
    <span class="md-ellipsis">
      isel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.FeatureMixin.latest" class="md-nav__link">
    <span class="md-ellipsis">
      latest
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.FeatureMixin.nearest_horizontal" class="md-nav__link">
    <span class="md-ellipsis">
      nearest_horizontal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.FeatureMixin.nearest_time" class="md-nav__link">
    <span class="md-ellipsis">
      nearest_time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.FeatureMixin.nearest_vertical" class="md-nav__link">
    <span class="md-ellipsis">
      nearest_vertical
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.FeatureMixin.sel" class="md-nav__link">
    <span class="md-ellipsis">
      sel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.FeatureMixin.time_range" class="md-nav__link">
    <span class="md-ellipsis">
      time_range
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.FeatureMixin.to_netcdf" class="md-nav__link">
    <span class="md-ellipsis">
      to_netcdf
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geokube.core.feature.GridFeature" class="md-nav__link">
    <span class="md-ellipsis">
      GridFeature
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GridFeature">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.GridFeature.as_points" class="md-nav__link">
    <span class="md-ellipsis">
      as_points
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.GridFeature.nearest_horizontal" class="md-nav__link">
    <span class="md-ellipsis">
      nearest_horizontal
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geokube.core.feature.PointsFeature" class="md-nav__link">
    <span class="md-ellipsis">
      PointsFeature
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PointsFeature">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.PointsFeature.number_of_points" class="md-nav__link">
    <span class="md-ellipsis">
      number_of_points
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geokube.core.feature.ProfilesFeature" class="md-nav__link">
    <span class="md-ellipsis">
      ProfilesFeature
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ProfilesFeature">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.ProfilesFeature.number_of_levels" class="md-nav__link">
    <span class="md-ellipsis">
      number_of_levels
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.ProfilesFeature.number_of_profiles" class="md-nav__link">
    <span class="md-ellipsis">
      number_of_profiles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.ProfilesFeature.as_points" class="md-nav__link">
    <span class="md-ellipsis">
      as_points
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.ProfilesFeature.bounding_box" class="md-nav__link">
    <span class="md-ellipsis">
      bounding_box
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geokube.core.feature.ProfilesFeature.nearest_vertical" class="md-nav__link">
    <span class="md-ellipsis">
      nearest_vertical
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Feature</h1>

<div class="doc doc-object doc-module">



<a id="geokube.core.feature"></a>
  <div class="doc doc-contents first">
  
      <h2 id="geokube.core.feature--feature">Feature</h2>
<p>A feature construct that serves as a base class for domains and fields.</p>



  <p><strong>Classes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code><span title="geokube.core.feature.:class:`geokube.core.feature.FeatureMixin`">:class:`geokube.core.feature.FeatureMixin`</span></code></td>
          <td>
            <div class="doc-md-description">
              <p>Mixin class for common domain and field properties and methods.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><span title="geokube.core.feature.:class:`geokube.core.feature.Feature`">:class:`geokube.core.feature.Feature`</span></code></td>
          <td>
            <div class="doc-md-description">
              <p>Base class for feature, domain, and field constructs.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><span title="geokube.core.feature.:class:`geokube.core.feature.PointsFeature`">:class:`geokube.core.feature.PointsFeature`</span></code></td>
          <td>
            <div class="doc-md-description">
              <p>Feature defined on a point domain.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><span title="geokube.core.feature.:class:`geokube.core.feature.ProfilesFeature`">:class:`geokube.core.feature.ProfilesFeature`</span></code></td>
          <td>
            <div class="doc-md-description">
              <p>Feature defined on a profile domain.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><span title="geokube.core.feature.:class:`geokube.core.feature.GridFeature`">:class:`geokube.core.feature.GridFeature`</span></code></td>
          <td>
            <div class="doc-md-description">
              <p>Feature defined on a gridded domain.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="geokube.core.feature.Feature" class="doc doc-heading">
          <code>Feature</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="geokube.core.feature.FeatureMixin" href="#geokube.core.feature.FeatureMixin">FeatureMixin</a></code></p>

  
      <p>Base class for feature constructs.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ds</code></td>
          <td>
                <code>xarray dataset</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>CF-compliant dataset with all the inputs.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cf_mappings</code></td>
          <td>
                <code>dict_like</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>CF-compliant hints</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.Feature.coords" href="#geokube.core.feature.FeatureMixin.coords">coords</a></code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return the coordinates of a domain, with their units.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.Feature.coord_system" href="#geokube.core.feature.FeatureMixin.coord_system">coord_system</a></code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="geokube.core.coord_system.CoordinateSystem" href="coord_system.html#geokube.core.coord_system.CoordinateSystem">CoordinateSystem</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return the coordinate system of a domain.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.Feature.crs" href="#geokube.core.feature.FeatureMixin.crs">crs</a></code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="geokube.core.crs.CRS" href="crs.html#geokube.core.crs.CRS">CRS</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return the coordinate reference system of a domain.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.Feature.dim_axes" href="#geokube.core.feature.FeatureMixin.dim_axes">dim_axes</a></code></td>
          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return the dimension axes of a domain.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.Feature.dim_coords" href="#geokube.core.feature.FeatureMixin.dim_coords">dim_coords</a></code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return the dimension coordinates of a domain.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.Feature.aux_axes" href="#geokube.core.feature.FeatureMixin.aux_axes">aux_axes</a></code></td>
          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return the auxiliary axes of a domain.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.Feature.aux_coords" href="#geokube.core.feature.FeatureMixin.aux_coords">aux_coords</a></code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return the auxiliary coordinates of a domain.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Methods:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.Feature.sel" href="#geokube.core.feature.FeatureMixin.sel">sel</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return a new feature, domain, or field selected by labels.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.Feature.isel" href="#geokube.core.feature.FeatureMixin.isel">isel</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return a new feature, domain, or field selected by indexes.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.Feature.bounding_box" href="#geokube.core.feature.FeatureMixin.bounding_box">bounding_box</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return a subset defined with a bounding box.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.Feature.nearest_horizontal" href="#geokube.core.feature.FeatureMixin.nearest_horizontal">nearest_horizontal</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return the nearest horizontal locations from the domain.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.Feature.nearest_vertical" href="#geokube.core.feature.FeatureMixin.nearest_vertical">nearest_vertical</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return the nearest vertical locations from the domain.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.Feature.time_range" href="#geokube.core.feature.FeatureMixin.time_range">time_range</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return a subset defined within the time bounds.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.Feature.nearest_time" href="#geokube.core.feature.FeatureMixin.nearest_time">nearest_time</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return a subset with the nearest time values.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.Feature.latest" href="#geokube.core.feature.FeatureMixin.latest">latest</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return a subset with just the latest (largest) time value.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.Feature.to_netcdf" href="#geokube.core.feature.FeatureMixin.to_netcdf">to_netcdf</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Write the contents to a netCDF file.</p>
              </div>
            </td>
          </tr>
    </tbody>
  </table>

<details class="see-also" open>
  <summary>See Also</summary>
  <p>:class:<code>geokube.core.feature.PointsFeature</code> :
    Feature defined on a point domain.
:class:<code>geokube.core.feature.ProfilesFeature</code> :
    Feature defined on a profile domain.
:class:<code>geokube.core.feature.GridFeature</code> :
    Feature defined on a gridded domain.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>geokube/core/feature.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Feature</span><span class="p">(</span><span class="n">FeatureMixin</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class for feature constructs.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ds : xarray dataset</span>
<span class="sd">        CF-compliant dataset with all the inputs.</span>
<span class="sd">    cf_mappings : dict_like</span>
<span class="sd">        CF-compliant hints</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    coords : dict</span>
<span class="sd">        Return the coordinates of a domain, with their units.</span>
<span class="sd">    coord_system : CoordinateSystem</span>
<span class="sd">        Return the coordinate system of a domain.</span>
<span class="sd">    crs : CRS</span>
<span class="sd">        Return the coordinate reference system of a domain.</span>
<span class="sd">    dim_axes : tuple</span>
<span class="sd">        Return the dimension axes of a domain.</span>
<span class="sd">    dim_coords : dict</span>
<span class="sd">        Return the dimension coordinates of a domain.</span>
<span class="sd">    aux_axes : tuple</span>
<span class="sd">        Return the auxiliary axes of a domain.</span>
<span class="sd">    aux_coords : dict</span>
<span class="sd">        Return the auxiliary coordinates of a domain.</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    sel(indexers, **xarray_kwargs)</span>
<span class="sd">        Return a new feature, domain, or field selected by labels.</span>
<span class="sd">    isel(indexers, **xarray_kwargs)</span>
<span class="sd">        Return a new feature, domain, or field selected by indexes.</span>
<span class="sd">    bounding_box(south, north, west, east, bottom, top)</span>
<span class="sd">        Return a subset defined with a bounding box.</span>
<span class="sd">    nearest_horizontal(latitude, longitude)</span>
<span class="sd">        Return the nearest horizontal locations from the domain.</span>
<span class="sd">    nearest_vertical(elevation)</span>
<span class="sd">        Return the nearest vertical locations from the domain.</span>
<span class="sd">    time_range(start, end)</span>
<span class="sd">        Return a subset defined within the time bounds.</span>
<span class="sd">    nearest_time(time)</span>
<span class="sd">        Return a subset with the nearest time values.</span>
<span class="sd">    latest()</span>
<span class="sd">        Return a subset with just the latest (largest) time value.</span>
<span class="sd">    to_netcdf(path, **xarray_kwargs)</span>
<span class="sd">        Write the contents to a netCDF file.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    :class:`geokube.core.feature.PointsFeature` :</span>
<span class="sd">        Feature defined on a point domain.</span>
<span class="sd">    :class:`geokube.core.feature.ProfilesFeature` :</span>
<span class="sd">        Feature defined on a profile domain.</span>
<span class="sd">    :class:`geokube.core.feature.GridFeature` :</span>
<span class="sd">        Feature defined on a gridded domain.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s1">&#39;_dset&#39;</span><span class="p">,</span> <span class="s1">&#39;_coord_system&#39;</span><span class="p">,</span> <span class="s1">&#39;_coords&#39;</span><span class="p">,</span> <span class="s1">&#39;_aux_coords&#39;</span><span class="p">,</span> <span class="s1">&#39;_dim_coords&#39;</span>
    <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ds</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="c1"># This should be CF-compliant or use cf_mapping to be a CF-compliant</span>
        <span class="n">cf_mappings</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># this could be used to pass CF compliant hints</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># TODO: check if xarray dataset is CF compliant (otherwise raise an error)       </span>
        <span class="c1"># Horizontal coordinate system:</span>
        <span class="c1"># TODO: manage cf_mappings</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span> <span class="o">=</span> <span class="n">ds</span>
        <span class="n">ds_coords</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">gmn</span> <span class="o">:=</span> <span class="n">ds</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">grid_mapping_names</span><span class="p">:</span>
            <span class="n">crs_var_name</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">gmn</span><span class="o">.</span><span class="n">values</span><span class="p">()))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">hor_crs</span> <span class="o">=</span> <span class="n">CRS</span><span class="o">.</span><span class="n">from_cf</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="n">crs_var_name</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">)</span>
            <span class="n">ds_coords</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">crs_var_name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># TODO: implement a function to guess the CRS</span>
            <span class="n">hor_crs</span> <span class="o">=</span> <span class="n">Geodetic</span><span class="p">()</span>

        <span class="c1"># Coordinates.</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">cf_coord</span><span class="p">,</span> <span class="n">cf_coord_names</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">coordinates</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">cf_coord_names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
            <span class="n">cf_coord_name</span> <span class="o">=</span> <span class="n">cf_coord_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">coord</span> <span class="o">=</span> <span class="n">ds_coords</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">cf_coord_name</span><span class="p">)</span>
            <span class="n">axis_</span> <span class="o">=</span> <span class="n">axis</span><span class="o">.</span><span class="n">_from_string</span><span class="p">(</span><span class="n">cf_coord</span><span class="p">)</span>
            <span class="n">coords</span><span class="p">[</span><span class="n">axis_</span><span class="p">]</span> <span class="o">=</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span>
                <span class="n">coord</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="n">coord</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;units&#39;</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="k">for</span> <span class="n">cf_axis</span><span class="p">,</span> <span class="n">cf_axis_names</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">cf_axis_names</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
            <span class="n">cf_axis_name</span> <span class="o">=</span> <span class="n">cf_axis_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">cf_axis_name</span> <span class="ow">in</span> <span class="n">ds_coords</span><span class="p">:</span>
                <span class="n">coord</span> <span class="o">=</span> <span class="n">ds_coords</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">cf_axis_name</span><span class="p">)</span>
                <span class="n">axis_</span> <span class="o">=</span> <span class="n">axis</span><span class="o">.</span><span class="n">_from_string</span><span class="p">(</span><span class="n">cf_axis</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">hor_crs</span><span class="p">,</span> <span class="n">RotatedGeodetic</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">axis_</span> <span class="ow">is</span> <span class="n">axis</span><span class="o">.</span><span class="n">x</span><span class="p">:</span>
                        <span class="n">axis_</span> <span class="o">=</span> <span class="n">axis</span><span class="o">.</span><span class="n">grid_longitude</span>
                    <span class="k">elif</span> <span class="n">axis_</span> <span class="ow">is</span> <span class="n">axis</span><span class="o">.</span><span class="n">y</span><span class="p">:</span>
                        <span class="n">axis_</span> <span class="o">=</span> <span class="n">axis</span><span class="o">.</span><span class="n">grid_latitude</span>
                <span class="n">coords</span><span class="p">[</span><span class="n">axis_</span><span class="p">]</span> <span class="o">=</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span>
                    <span class="n">coord</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="n">coord</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;units&#39;</span><span class="p">)</span>
                <span class="p">)</span>

        <span class="c1"># Coordinate system.</span>
        <span class="n">time</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">axis_</span>
            <span class="k">for</span> <span class="n">axis_</span> <span class="ow">in</span> <span class="n">coords</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axis_</span><span class="p">,</span> <span class="n">axis</span><span class="o">.</span><span class="n">Time</span><span class="p">)</span> <span class="ow">and</span> <span class="n">coords</span><span class="p">[</span><span class="n">axis_</span><span class="p">]</span><span class="o">.</span><span class="n">ndim</span>
        <span class="p">}</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span>
        <span class="n">elev</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">axis_</span>
            <span class="k">for</span> <span class="n">axis_</span> <span class="ow">in</span> <span class="n">coords</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axis_</span><span class="p">,</span> <span class="n">axis</span><span class="o">.</span><span class="n">Elevation</span><span class="p">)</span> <span class="ow">and</span> <span class="n">coords</span><span class="p">[</span><span class="n">axis_</span><span class="p">]</span><span class="o">.</span><span class="n">ndim</span>
        <span class="p">}</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">elev</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span>
        <span class="c1"># TODO: Add user axes.</span>
        <span class="n">coord_system</span> <span class="o">=</span> <span class="n">CoordinateSystem</span><span class="p">(</span>
            <span class="n">horizontal</span><span class="o">=</span><span class="n">hor_crs</span><span class="p">,</span>
            <span class="n">elevation</span><span class="o">=</span><span class="n">elev</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span> <span class="k">if</span> <span class="n">elev</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span> <span class="k">if</span> <span class="n">time</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_coord_system</span> <span class="o">=</span> <span class="n">coord_system</span>

        <span class="c1"># self._coords = {</span>
        <span class="c1">#     axis_: ds[axis_].pint.quantify().data</span>
        <span class="c1">#     for axis_ in coord_system.axes</span>
        <span class="c1"># }</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">axis_</span> <span class="ow">in</span> <span class="n">coord_system</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span>
            <span class="n">darr</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">axis_</span><span class="p">]</span>
            <span class="n">coords</span><span class="p">[</span><span class="n">axis_</span><span class="p">]</span> <span class="o">=</span> <span class="n">create_quantity</span><span class="p">(</span>
                <span class="n">darr</span><span class="p">,</span> <span class="n">darr</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;units&#39;</span><span class="p">),</span> <span class="n">darr</span><span class="o">.</span><span class="n">dtype</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_coords</span> <span class="o">=</span> <span class="n">coords</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_dim_coords</span> <span class="o">=</span> <span class="p">{</span><span class="n">ax</span><span class="p">:</span> <span class="n">ds</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">coord_system</span><span class="o">.</span><span class="n">dim_axes</span><span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_aux_coords</span> <span class="o">=</span> <span class="p">{</span><span class="n">ax</span><span class="p">:</span> <span class="n">ds</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">coord_system</span><span class="o">.</span><span class="n">aux_axes</span><span class="p">}</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return ``self == other``.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span><span class="o">.</span><span class="n">identical</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">_dset</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return ``self != other``.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span> <span class="o">==</span> <span class="n">other</span>

    <span class="k">def</span> <span class="nf">_get_var_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="n">all_vars</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">anc_vars</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">var_name</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">all_vars</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">var_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">anc_attr</span> <span class="o">:=</span> <span class="n">var</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ancillary_variables&#39;</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">anc_vars</span> <span class="o">|=</span> <span class="nb">set</span><span class="p">(</span><span class="n">anc_attr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">all_vars</span> <span class="o">-</span> <span class="n">anc_vars</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_from_xarray_dataset</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">ds</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span>
        <span class="n">cf_mappings</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># this could be used to pass CF compliant hints</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span> <span class="n">cf_mappings</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="geokube.core.feature.Feature.__eq__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Return <code>self == other</code>.</p>

          <details class="quote">
            <summary>Source code in <code>geokube/core/feature.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return ``self == other``.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span><span class="o">.</span><span class="n">identical</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">_dset</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="geokube.core.feature.Feature.__ne__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__ne__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Return <code>self != other</code>.</p>

          <details class="quote">
            <summary>Source code in <code>geokube/core/feature.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return ``self != other``.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span> <span class="o">==</span> <span class="n">other</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="geokube.core.feature.FeatureMixin" class="doc doc-heading">
          <code>FeatureMixin</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>Mixin class for common domain and field properties and methods.</p>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.FeatureMixin.coords" href="#geokube.core.feature.FeatureMixin.coords">coords</a></code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return the coordinates of a domain, with their units.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.FeatureMixin.coord_system" href="#geokube.core.feature.FeatureMixin.coord_system">coord_system</a></code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="geokube.core.coord_system.CoordinateSystem" href="coord_system.html#geokube.core.coord_system.CoordinateSystem">CoordinateSystem</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return the coordinate system of a domain.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.FeatureMixin.crs" href="#geokube.core.feature.FeatureMixin.crs">crs</a></code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="geokube.core.crs.CRS" href="crs.html#geokube.core.crs.CRS">CRS</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return the coordinate reference system of a domain.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.FeatureMixin.dim_axes" href="#geokube.core.feature.FeatureMixin.dim_axes">dim_axes</a></code></td>
          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return the dimension axes of a domain.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.FeatureMixin.dim_coords" href="#geokube.core.feature.FeatureMixin.dim_coords">dim_coords</a></code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return the dimension coordinates of a domain.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.FeatureMixin.aux_axes" href="#geokube.core.feature.FeatureMixin.aux_axes">aux_axes</a></code></td>
          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return the auxiliary axes of a domain.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.FeatureMixin.aux_coords" href="#geokube.core.feature.FeatureMixin.aux_coords">aux_coords</a></code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return the auxiliary coordinates of a domain.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Methods:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.FeatureMixin.sel" href="#geokube.core.feature.FeatureMixin.sel">sel</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return a new feature, domain, or field selected by labels.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.FeatureMixin.isel" href="#geokube.core.feature.FeatureMixin.isel">isel</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return a new feature, domain, or field selected by indexes.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.FeatureMixin.bounding_box" href="#geokube.core.feature.FeatureMixin.bounding_box">bounding_box</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return a subset defined with a bounding box.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.FeatureMixin.nearest_horizontal" href="#geokube.core.feature.FeatureMixin.nearest_horizontal">nearest_horizontal</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return the nearest horizontal locations from the domain.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.FeatureMixin.nearest_vertical" href="#geokube.core.feature.FeatureMixin.nearest_vertical">nearest_vertical</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return the nearest vertical locations from the domain.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.FeatureMixin.time_range" href="#geokube.core.feature.FeatureMixin.time_range">time_range</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return a subset defined within the time bounds.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.FeatureMixin.nearest_time" href="#geokube.core.feature.FeatureMixin.nearest_time">nearest_time</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return a subset with the nearest time values.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.FeatureMixin.latest" href="#geokube.core.feature.FeatureMixin.latest">latest</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return a subset with just the latest (largest) time value.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.FeatureMixin.to_netcdf" href="#geokube.core.feature.FeatureMixin.to_netcdf">to_netcdf</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Write the contents to a netCDF file.</p>
              </div>
            </td>
          </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>geokube/core/feature.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">FeatureMixin</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Mixin class for common domain and field properties and methods.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    coords : dict</span>
<span class="sd">        Return the coordinates of a domain, with their units.</span>
<span class="sd">    coord_system : CoordinateSystem</span>
<span class="sd">        Return the coordinate system of a domain.</span>
<span class="sd">    crs : CRS</span>
<span class="sd">        Return the coordinate reference system of a domain.</span>
<span class="sd">    dim_axes : tuple</span>
<span class="sd">        Return the dimension axes of a domain.</span>
<span class="sd">    dim_coords : dict</span>
<span class="sd">        Return the dimension coordinates of a domain.</span>
<span class="sd">    aux_axes : tuple</span>
<span class="sd">        Return the auxiliary axes of a domain.</span>
<span class="sd">    aux_coords : dict</span>
<span class="sd">        Return the auxiliary coordinates of a domain.</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    sel(indexers, **xarray_kwargs)</span>
<span class="sd">        Return a new feature, domain, or field selected by labels.</span>
<span class="sd">    isel(indexers, **xarray_kwargs)</span>
<span class="sd">        Return a new feature, domain, or field selected by indexes.</span>
<span class="sd">    bounding_box(south, north, west, east, bottom, top)</span>
<span class="sd">        Return a subset defined with a bounding box.</span>
<span class="sd">    nearest_horizontal(latitude, longitude)</span>
<span class="sd">        Return the nearest horizontal locations from the domain.</span>
<span class="sd">    nearest_vertical(elevation)</span>
<span class="sd">        Return the nearest vertical locations from the domain.</span>
<span class="sd">    time_range(start, end)</span>
<span class="sd">        Return a subset defined within the time bounds.</span>
<span class="sd">    nearest_time(time)</span>
<span class="sd">        Return a subset with the nearest time values.</span>
<span class="sd">    latest()</span>
<span class="sd">        Return a subset with just the latest (largest) time value.</span>
<span class="sd">    to_netcdf(path, **xarray_kwargs)</span>
<span class="sd">        Write the contents to a netCDF file.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">coords</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">axis</span><span class="o">.</span><span class="n">Axis</span><span class="p">,</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the coordinates of a domain, with their units.</span>

<span class="sd">        The coordinates contain the axes, coordinate values, and</span>
<span class="sd">        coordinate units.  They are represented as a `dict` with the</span>
<span class="sd">        :class:`geokube.core.axis.Axis` instance keys and</span>
<span class="sd">        :class:`pint.Quantity` values.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coords</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">coord_system</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CoordinateSystem</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the coordinate system of a domain.</span>

<span class="sd">        The coordinate system is an instance of the class</span>
<span class="sd">        :class:`geokube.core.coord_system.CoordinateSystem`.  It</span>
<span class="sd">        contains the information on the spatial, temporal, and other</span>
<span class="sd">        axes and related units, as well as about the horizontal</span>
<span class="sd">        coordinate reference system.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coord_system</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">crs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CRS</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the coordinate reference system of a domain.</span>

<span class="sd">        The horizontal coordinate reference system is an instance of a</span>
<span class="sd">        subclass of the class :class:`geokube.core.crs.CRS`.  It</span>
<span class="sd">        contains dimension and auxiliary horizontal axes, and can be</span>
<span class="sd">        used for transformations.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">coord_system</span><span class="o">.</span><span class="n">spatial</span><span class="o">.</span><span class="n">crs</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dim_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">axis</span><span class="o">.</span><span class="n">Axis</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the dimension axes of a domain.</span>

<span class="sd">        There can be any number of kind of axes.  They are represented</span>
<span class="sd">        as a `tuple` of :class:`geokube.core.axis.Axis` instances.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">coord_system</span><span class="o">.</span><span class="n">dim_axes</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dim_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">axis</span><span class="o">.</span><span class="n">Axis</span><span class="p">,</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the dimension coordinates of a domain.</span>

<span class="sd">        The coordinates contain the axes, coordinate values, and</span>
<span class="sd">        coordinate units.  They are represented as a dict with the</span>
<span class="sd">        :class:`geokube.core.axis.Axis` instance keys and</span>
<span class="sd">        :class:`pint.Quantity` values.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dim_coords</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">aux_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">axis</span><span class="o">.</span><span class="n">Horizontal</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the auxiliary axes of a domain.</span>

<span class="sd">        Auxiliary axes can be only horizontal.  They are represented</span>
<span class="sd">        as a tuple of :class:`geokube.core.axis.Horizontal` instances.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">coord_system</span><span class="o">.</span><span class="n">aux_axes</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">aux_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">axis</span><span class="o">.</span><span class="n">Axis</span><span class="p">,</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the auxiliary coordinates of a domain.</span>

<span class="sd">        The coordinates contain the axes, coordinate values, and</span>
<span class="sd">        coordinate units.  They are represented as a dict with the</span>
<span class="sd">        :class:`geokube.core.axis.Axis` instance keys and</span>
<span class="sd">        :class:`pint.Quantity` values.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aux_coords</span>

    <span class="k">def</span> <span class="nf">sel</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">indexers</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="n">axis</span><span class="o">.</span><span class="n">Axis</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">xarray_kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new feature, domain, or field selected by labels.</span>

<span class="sd">        The subsetting operation can be done only along the dimensions.</span>
<span class="sd">        Subsetting is unit-aware, which means that unit conversion can</span>
<span class="sd">        be performed on the labels in the background if necesssary.</span>
<span class="sd">        The coordinates and data variables are reduced.  The type of</span>
<span class="sd">        the caller and other data are preserved.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        indexers : dict-like, optional</span>
<span class="sd">            A mapping with the keys that must be the dimensional axes</span>
<span class="sd">            and the values that represent the corresponding labels.</span>
<span class="sd">            The values can be scalars, arrays, or slices. They can have</span>
<span class="sd">            the units (i.e. can be instances of the class</span>
<span class="sd">            :class:`pint.Quantity`).  If a label does not have a unit,</span>
<span class="sd">            then it is assumed that its unit is the default unit for</span>
<span class="sd">            the corresponding axis (key).</span>

<span class="sd">        xarray_kwargs : dict, optional</span>
<span class="sd">            Keyword arguments passed to :meth:`xarray.Dataset.sel`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        out : caller type</span>
<span class="sd">            New feature, domain, or field created as a result of</span>
<span class="sd">            subsetting.  The type of the subsetted object is preserved.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">indexers</span><span class="o">=</span><span class="n">indexers</span><span class="p">,</span> <span class="o">**</span><span class="n">xarray_kwargs</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_from_xarray_dataset</span><span class="p">(</span><span class="n">dset</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">out</span>

    <span class="k">def</span> <span class="nf">isel</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">indexers</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="n">axis</span><span class="o">.</span><span class="n">Axis</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">xarray_kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a new feature, domain, or field selected by indexes.</span>

<span class="sd">        The subsetting operation can be done only along the dimensions.</span>
<span class="sd">        The coordinates and data variables are reduced.  The type of</span>
<span class="sd">        the caller and other data are preserved.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        indexers : dict-like, optional</span>
<span class="sd">            A mapping with the keys that must be the dimensional axes</span>
<span class="sd">            and the values that represent the corresponding integer</span>
<span class="sd">            indexes.</span>

<span class="sd">        xarray_kwargs : dict, optional</span>
<span class="sd">            Keyword arguments passed to :meth:`xarray.Dataset.isel`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        out : caller type</span>
<span class="sd">            New feature, domain, or field created as a result of</span>
<span class="sd">            subsetting.  The type of the subsetted object is preserved.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">indexers</span><span class="p">,</span> <span class="o">**</span><span class="n">xarray_kwargs</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_from_xarray_dataset</span><span class="p">(</span><span class="n">dset</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">out</span>

    <span class="c1"># Spatial subsetting ------------------------------------------------------</span>

    <span class="k">def</span> <span class="nf">bounding_box</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">south</span><span class="p">:</span> <span class="n">Number</span> <span class="o">|</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">north</span><span class="p">:</span> <span class="n">Number</span> <span class="o">|</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">west</span><span class="p">:</span> <span class="n">Number</span> <span class="o">|</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">east</span><span class="p">:</span> <span class="n">Number</span> <span class="o">|</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">bottom</span><span class="p">:</span> <span class="n">Number</span> <span class="o">|</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">top</span><span class="p">:</span> <span class="n">Number</span> <span class="o">|</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a subset defined with a bounding box.</span>

<span class="sd">        This operation extracts a subset of values within a bounding</span>
<span class="sd">        box specified with the parameters north, south, east, and west.</span>
<span class="sd">        It is unit-aware, which means that the units do not need to be</span>
<span class="sd">        converted before passing to the method.  If a quantity is</span>
<span class="sd">        passed, the units are automatically adjusted.  If just a number</span>
<span class="sd">        is provided, it is assumed that the units are the same as the</span>
<span class="sd">        corresponding coordinate.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        south, north, west, east : number or quantity, optional</span>
<span class="sd">            Horizontal bounds.</span>
<span class="sd">        bottom, top : number or quantity, optional</span>
<span class="sd">            Vertical bounds.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        feature : caller type</span>
<span class="sd">            A feature, domain, or field obtained after subsetting the</span>
<span class="sd">            caller.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO: manage when north, south, west and east are None</span>
        <span class="c1"># we need to consider min/max for lat/lon</span>
        <span class="n">h_idx</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">latitude</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="n">south</span><span class="p">,</span> <span class="n">north</span><span class="p">),</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">longitude</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="n">west</span><span class="p">,</span> <span class="n">east</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="n">feature</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">h_idx</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">bottom</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">top</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="n">feature</span> <span class="o">=</span> <span class="n">feature</span><span class="o">.</span><span class="n">sel</span><span class="p">({</span><span class="n">axis</span><span class="o">.</span><span class="n">vertical</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="n">bottom</span><span class="p">,</span> <span class="n">top</span><span class="p">)})</span>
        <span class="k">return</span> <span class="n">feature</span>

    <span class="k">def</span> <span class="nf">nearest_horizontal</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">latitude</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span> <span class="o">|</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">,</span>
        <span class="n">longitude</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span> <span class="o">|</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the nearest horizontal locations from the domain.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        latitude, longitude : array_like or quantity</span>
<span class="sd">            Horizontal coordinates for subsetting.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        caller type</span>
<span class="sd">            A feature, domain, or field with the the nearest horizontal</span>
<span class="sd">            locations from the domain to all latitude-longitude pairs.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="p">{</span><span class="n">axis</span><span class="o">.</span><span class="n">latitude</span><span class="p">:</span> <span class="n">latitude</span><span class="p">,</span> <span class="n">axis</span><span class="o">.</span><span class="n">longitude</span><span class="p">:</span> <span class="n">longitude</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">nearest_vertical</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">elevation</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span> <span class="o">|</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the nearest vertical locations from the domain.</span>

<span class="sd">        This operation is unit-aware, which means that the units do not</span>
<span class="sd">        need to be converted before passing to the method.  If a</span>
<span class="sd">        quantity is passed, the units are automatically adjusted.  If</span>
<span class="sd">        just a number or array is provided, it is assumed that the units</span>
<span class="sd">        are the same as the corresponding coordinate.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        elevation : array_like or quantity</span>
<span class="sd">            Vertical coordinates for subsetting.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        caller type</span>
<span class="sd">            A feature, domain, or field with the the nearest vertical</span>
<span class="sd">            locations to the elevation.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="p">{</span><span class="n">axis</span><span class="o">.</span><span class="n">vertical</span><span class="p">:</span> <span class="n">elevation</span><span class="p">}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>

    <span class="c1"># Temporal subsetting -----------------------------------------------------</span>

    <span class="k">def</span> <span class="nf">time_range</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">start</span><span class="p">:</span> <span class="n">date</span> <span class="o">|</span> <span class="n">datetime</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">end</span><span class="p">:</span> <span class="n">date</span> <span class="o">|</span> <span class="n">datetime</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a subset defined within the time bounds.</span>

<span class="sd">        This operation extracts a subset of values along the time axis,</span>
<span class="sd">        within the time interval between `start` and `end`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        start, end : date, datetime, or str, optional</span>
<span class="sd">            Time bounds.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        caller type</span>
<span class="sd">            A feature, domain, or field obtained after subsetting the</span>
<span class="sd">            caller along the time axis.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="p">{</span><span class="n">axis</span><span class="o">.</span><span class="n">time</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">nearest_time</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="n">date</span> <span class="o">|</span> <span class="n">datetime</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a subset with the nearest time values.</span>

<span class="sd">        This operation extracts a subset of values along the time axis,</span>
<span class="sd">        which are nearest to the values specified with `time`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        time : array_like, optional</span>
<span class="sd">            Time values to search for.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        caller type</span>
<span class="sd">            A feature, domain, or field obtained after subsetting the</span>
<span class="sd">            caller along the time axis.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="p">{</span><span class="n">axis</span><span class="o">.</span><span class="n">time</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">time</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">latest</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a subset with just the latest (largest) time value.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        caller type</span>
<span class="sd">            A feature, domain, or field obtained after subsetting the</span>
<span class="sd">            caller along the time axis.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        NotImplementedError</span>
<span class="sd">            If the time axis is not present.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">axis</span><span class="o">.</span><span class="n">time</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
        <span class="n">latest</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span><span class="p">[</span><span class="n">axis</span><span class="o">.</span><span class="n">time</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="p">{</span><span class="n">axis</span><span class="o">.</span><span class="n">time</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="n">latest</span><span class="p">,</span> <span class="n">latest</span><span class="p">)}</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>

    <span class="c1"># Writing to file ---------------------------------------------------------</span>

    <span class="k">def</span> <span class="nf">to_netcdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">xarray_kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write the contents to a netCDF file.</span>

<span class="sd">        This operation extracts a subset of values along the time axis,</span>
<span class="sd">        which are nearest to the values specified with `time`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path : str</span>
<span class="sd">            The path of the target netCDF file.</span>
<span class="sd">        **xarray_kwargs : dict, optional</span>
<span class="sd">            Extra arguments to :meth:`xarray.Dataset.to_netcdf`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span>
        <span class="n">dset</span> <span class="o">=</span> <span class="n">dset</span><span class="o">.</span><span class="n">drop_indexes</span><span class="p">(</span><span class="n">dset</span><span class="o">.</span><span class="n">xindexes</span><span class="p">)</span>

        <span class="n">coords</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">dset</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">axis_</span><span class="p">,</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">coords</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axis_</span><span class="p">,</span> <span class="n">axis</span><span class="o">.</span><span class="n">Axis</span><span class="p">):</span>
                <span class="n">axes</span><span class="p">[</span><span class="n">axis_</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">coord</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">)</span>
                    <span class="ow">or</span> <span class="n">axis_</span><span class="o">.</span><span class="n">encoding</span><span class="p">[</span><span class="s1">&#39;standard_name&#39;</span><span class="p">]</span>
                <span class="p">)</span>
        <span class="n">dims</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="n">dset</span><span class="o">.</span><span class="n">dims</span><span class="p">:</span>
            <span class="n">names</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">dims</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="nb">isinstance</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">axis</span><span class="o">.</span><span class="n">Axis</span><span class="p">)</span>
                <span class="ow">and</span> <span class="p">(</span><span class="n">dim_name</span> <span class="o">:=</span> <span class="n">dim</span><span class="o">.</span><span class="n">encoding</span><span class="p">[</span><span class="s1">&#39;standard_name&#39;</span><span class="p">])</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">names</span>
            <span class="p">):</span>
                <span class="n">dims</span><span class="p">[</span><span class="n">dim</span><span class="p">]</span> <span class="o">=</span> <span class="n">dim_name</span>
        <span class="n">dset</span> <span class="o">=</span> <span class="n">dset</span><span class="o">.</span><span class="n">rename_vars</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span><span class="o">.</span><span class="n">swap_dims</span><span class="p">(</span><span class="n">dims</span><span class="p">)</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="p">(</span><span class="n">time_coord</span> <span class="o">:=</span> <span class="n">coords</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">axis</span><span class="o">.</span><span class="n">time</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="ow">and</span> <span class="p">(</span>
                <span class="p">(</span><span class="n">bnds</span> <span class="o">:=</span> <span class="n">time_coord</span><span class="o">.</span><span class="n">encoding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;bounds&#39;</span><span class="p">))</span>
                <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;time_bnds&#39;</span><span class="p">,</span> <span class="s1">&#39;time_bounds&#39;</span><span class="p">}</span>
            <span class="p">)</span>
            <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">time_coord</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">Interval</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="n">inter</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">IntervalIndex</span><span class="p">(</span><span class="n">time_coord</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">())</span>
            <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">inter</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="n">inter</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
            <span class="n">time_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">time_coord</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">left</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="n">time_vals</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">time_vals</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span>
            <span class="n">dset</span> <span class="o">=</span> <span class="n">dset</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span>
                <span class="n">coords</span><span class="o">=</span><span class="p">{</span>
                    <span class="n">bnds</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;bnds&#39;</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="n">time_vals</span><span class="p">),</span>
                    <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span>
                        <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,),</span>
                        <span class="n">data</span><span class="o">=</span><span class="n">left</span><span class="p">,</span>
                        <span class="n">attrs</span><span class="o">=</span><span class="n">time_coord</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
                        <span class="n">encoding</span><span class="o">=</span><span class="n">time_coord</span><span class="o">.</span><span class="n">encoding</span>
                    <span class="p">)</span>
                <span class="p">}</span>
            <span class="p">)</span>

        <span class="c1"># TODO: Use `itertools.chain` to create a single loop.</span>
        <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">dset</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">attrs</span> <span class="o">=</span> <span class="n">coord</span><span class="o">.</span><span class="n">attrs</span>
            <span class="k">if</span> <span class="s1">&#39;units&#39;</span> <span class="ow">in</span> <span class="n">attrs</span> <span class="ow">and</span> <span class="n">units</span><span class="p">[</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]]</span> <span class="o">==</span> <span class="n">units</span><span class="p">[</span><span class="kc">None</span><span class="p">]:</span>
                <span class="k">del</span> <span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">dset</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">attrs</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">attrs</span>
            <span class="k">if</span> <span class="s1">&#39;units&#39;</span> <span class="ow">in</span> <span class="n">attrs</span> <span class="ow">and</span> <span class="n">units</span><span class="p">[</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]]</span> <span class="o">==</span> <span class="n">units</span><span class="p">[</span><span class="kc">None</span><span class="p">]:</span>
                <span class="k">del</span> <span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span>

        <span class="n">dset</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;grid_mapping&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">gmn</span> <span class="o">:=</span> <span class="n">dset</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">grid_mapping_names</span><span class="p">:</span>
            <span class="n">crs_var_name</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">gmn</span><span class="o">.</span><span class="n">values</span><span class="p">()))[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">dset</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="n">var</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;grid_mapping&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="n">var</span><span class="o">.</span><span class="n">encoding</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;grid_mapping&#39;</span><span class="p">,</span> <span class="n">crs_var_name</span><span class="p">)</span>

        <span class="c1"># TODO: Improve squeezing.</span>
        <span class="n">dset</span> <span class="o">=</span> <span class="n">dset</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>

        <span class="n">dset</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">xarray_kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="geokube.core.feature.FeatureMixin.aux_axes" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">aux_axes</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">axis</span><span class="o">.</span><span class="n">Horizontal</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Return the auxiliary axes of a domain.</p>
<p>Auxiliary axes can be only horizontal.  They are represented
as a tuple of :class:<code>geokube.core.axis.Horizontal</code> instances.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="geokube.core.feature.FeatureMixin.aux_coords" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">aux_coords</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">axis</span><span class="o">.</span><span class="n">Axis</span><span class="p">,</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Return the auxiliary coordinates of a domain.</p>
<p>The coordinates contain the axes, coordinate values, and
coordinate units.  They are represented as a dict with the
:class:<code>geokube.core.axis.Axis</code> instance keys and
:class:<code>pint.Quantity</code> values.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="geokube.core.feature.FeatureMixin.coord_system" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">coord_system</span><span class="p">:</span> <span class="n">CoordinateSystem</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Return the coordinate system of a domain.</p>
<p>The coordinate system is an instance of the class
:class:<code>geokube.core.coord_system.CoordinateSystem</code>.  It
contains the information on the spatial, temporal, and other
axes and related units, as well as about the horizontal
coordinate reference system.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="geokube.core.feature.FeatureMixin.coords" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">coords</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">axis</span><span class="o">.</span><span class="n">Axis</span><span class="p">,</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Return the coordinates of a domain, with their units.</p>
<p>The coordinates contain the axes, coordinate values, and
coordinate units.  They are represented as a <code>dict</code> with the
:class:<code>geokube.core.axis.Axis</code> instance keys and
:class:<code>pint.Quantity</code> values.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="geokube.core.feature.FeatureMixin.crs" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">crs</span><span class="p">:</span> <span class="n">CRS</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Return the coordinate reference system of a domain.</p>
<p>The horizontal coordinate reference system is an instance of a
subclass of the class :class:<code>geokube.core.crs.CRS</code>.  It
contains dimension and auxiliary horizontal axes, and can be
used for transformations.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="geokube.core.feature.FeatureMixin.dim_axes" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">dim_axes</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">axis</span><span class="o">.</span><span class="n">Axis</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Return the dimension axes of a domain.</p>
<p>There can be any number of kind of axes.  They are represented
as a <code>tuple</code> of :class:<code>geokube.core.axis.Axis</code> instances.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="geokube.core.feature.FeatureMixin.dim_coords" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">dim_coords</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">axis</span><span class="o">.</span><span class="n">Axis</span><span class="p">,</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">]</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Return the dimension coordinates of a domain.</p>
<p>The coordinates contain the axes, coordinate values, and
coordinate units.  They are represented as a dict with the
:class:<code>geokube.core.axis.Axis</code> instance keys and
:class:<code>pint.Quantity</code> values.</p>
  </div>

</div>




<div class="doc doc-object doc-function">



<h3 id="geokube.core.feature.FeatureMixin.bounding_box" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">bounding_box</span><span class="p">(</span><span class="n">south</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">north</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">west</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">east</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Return a subset defined with a bounding box.</p>
<p>This operation extracts a subset of values within a bounding
box specified with the parameters north, south, east, and west.
It is unit-aware, which means that the units do not need to be
converted before passing to the method.  If a quantity is
passed, the units are automatically adjusted.  If just a number
is provided, it is assumed that the units are the same as the
corresponding coordinate.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>south</code></td>
          <td>
                <code>number or <span title="geokube.core.quantity">quantity</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Horizontal bounds.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>north</code></td>
          <td>
                <code>number or <span title="geokube.core.quantity">quantity</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Horizontal bounds.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>west</code></td>
          <td>
                <code>number or <span title="geokube.core.quantity">quantity</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Horizontal bounds.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>east</code></td>
          <td>
                <code>number or <span title="geokube.core.quantity">quantity</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Horizontal bounds.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>bottom</code></td>
          <td>
                <code>number or <span title="geokube.core.quantity">quantity</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Vertical bounds.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>top</code></td>
          <td>
                <code>number or <span title="geokube.core.quantity">quantity</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Vertical bounds.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>feature</code></td>          <td>
                <code>caller type</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A feature, domain, or field obtained after subsetting the
caller.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>geokube/core/feature.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">bounding_box</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">south</span><span class="p">:</span> <span class="n">Number</span> <span class="o">|</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">north</span><span class="p">:</span> <span class="n">Number</span> <span class="o">|</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">west</span><span class="p">:</span> <span class="n">Number</span> <span class="o">|</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">east</span><span class="p">:</span> <span class="n">Number</span> <span class="o">|</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">bottom</span><span class="p">:</span> <span class="n">Number</span> <span class="o">|</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">top</span><span class="p">:</span> <span class="n">Number</span> <span class="o">|</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a subset defined with a bounding box.</span>

<span class="sd">    This operation extracts a subset of values within a bounding</span>
<span class="sd">    box specified with the parameters north, south, east, and west.</span>
<span class="sd">    It is unit-aware, which means that the units do not need to be</span>
<span class="sd">    converted before passing to the method.  If a quantity is</span>
<span class="sd">    passed, the units are automatically adjusted.  If just a number</span>
<span class="sd">    is provided, it is assumed that the units are the same as the</span>
<span class="sd">    corresponding coordinate.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    south, north, west, east : number or quantity, optional</span>
<span class="sd">        Horizontal bounds.</span>
<span class="sd">    bottom, top : number or quantity, optional</span>
<span class="sd">        Vertical bounds.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    feature : caller type</span>
<span class="sd">        A feature, domain, or field obtained after subsetting the</span>
<span class="sd">        caller.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO: manage when north, south, west and east are None</span>
    <span class="c1"># we need to consider min/max for lat/lon</span>
    <span class="n">h_idx</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">latitude</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="n">south</span><span class="p">,</span> <span class="n">north</span><span class="p">),</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">longitude</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="n">west</span><span class="p">,</span> <span class="n">east</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="n">feature</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">h_idx</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">bottom</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">top</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">feature</span> <span class="o">=</span> <span class="n">feature</span><span class="o">.</span><span class="n">sel</span><span class="p">({</span><span class="n">axis</span><span class="o">.</span><span class="n">vertical</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="n">bottom</span><span class="p">,</span> <span class="n">top</span><span class="p">)})</span>
    <span class="k">return</span> <span class="n">feature</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="geokube.core.feature.FeatureMixin.isel" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">isel</span><span class="p">(</span><span class="n">indexers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">xarray_kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Return a new feature, domain, or field selected by indexes.</p>
<p>The subsetting operation can be done only along the dimensions.
The coordinates and data variables are reduced.  The type of
the caller and other data are preserved.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>indexers</code></td>
          <td>
                <code>dict - like</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A mapping with the keys that must be the dimensional axes
and the values that represent the corresponding integer
indexes.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>xarray_kwargs</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Keyword arguments passed to :meth:<code>xarray.Dataset.isel</code>.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>out</code></td>          <td>
                <code>caller type</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>New feature, domain, or field created as a result of
subsetting.  The type of the subsetted object is preserved.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>geokube/core/feature.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">isel</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">indexers</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="n">axis</span><span class="o">.</span><span class="n">Axis</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">xarray_kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new feature, domain, or field selected by indexes.</span>

<span class="sd">    The subsetting operation can be done only along the dimensions.</span>
<span class="sd">    The coordinates and data variables are reduced.  The type of</span>
<span class="sd">    the caller and other data are preserved.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    indexers : dict-like, optional</span>
<span class="sd">        A mapping with the keys that must be the dimensional axes</span>
<span class="sd">        and the values that represent the corresponding integer</span>
<span class="sd">        indexes.</span>

<span class="sd">    xarray_kwargs : dict, optional</span>
<span class="sd">        Keyword arguments passed to :meth:`xarray.Dataset.isel`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    out : caller type</span>
<span class="sd">        New feature, domain, or field created as a result of</span>
<span class="sd">        subsetting.  The type of the subsetted object is preserved.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">indexers</span><span class="p">,</span> <span class="o">**</span><span class="n">xarray_kwargs</span><span class="p">)</span>
    <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_from_xarray_dataset</span><span class="p">(</span><span class="n">dset</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">out</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="geokube.core.feature.FeatureMixin.latest" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">latest</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Return a subset with just the latest (largest) time value.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>caller type</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A feature, domain, or field obtained after subsetting the
caller along the time axis.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>NotImplementedError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the time axis is not present.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>geokube/core/feature.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">latest</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a subset with just the latest (largest) time value.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    caller type</span>
<span class="sd">        A feature, domain, or field obtained after subsetting the</span>
<span class="sd">        caller along the time axis.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    NotImplementedError</span>
<span class="sd">        If the time axis is not present.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">axis</span><span class="o">.</span><span class="n">time</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
    <span class="n">latest</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span><span class="p">[</span><span class="n">axis</span><span class="o">.</span><span class="n">time</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="p">{</span><span class="n">axis</span><span class="o">.</span><span class="n">time</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="n">latest</span><span class="p">,</span> <span class="n">latest</span><span class="p">)}</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="geokube.core.feature.FeatureMixin.nearest_horizontal" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">nearest_horizontal</span><span class="p">(</span><span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Return the nearest horizontal locations from the domain.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>latitude</code></td>
          <td>
                <code>array_like or <span title="geokube.core.quantity">quantity</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Horizontal coordinates for subsetting.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>longitude</code></td>
          <td>
                <code>array_like or <span title="geokube.core.quantity">quantity</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Horizontal coordinates for subsetting.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>caller type</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A feature, domain, or field with the the nearest horizontal
locations from the domain to all latitude-longitude pairs.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>geokube/core/feature.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">nearest_horizontal</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">latitude</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span> <span class="o">|</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">,</span>
    <span class="n">longitude</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span> <span class="o">|</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the nearest horizontal locations from the domain.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    latitude, longitude : array_like or quantity</span>
<span class="sd">        Horizontal coordinates for subsetting.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    caller type</span>
<span class="sd">        A feature, domain, or field with the the nearest horizontal</span>
<span class="sd">        locations from the domain to all latitude-longitude pairs.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="p">{</span><span class="n">axis</span><span class="o">.</span><span class="n">latitude</span><span class="p">:</span> <span class="n">latitude</span><span class="p">,</span> <span class="n">axis</span><span class="o">.</span><span class="n">longitude</span><span class="p">:</span> <span class="n">longitude</span><span class="p">}</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="geokube.core.feature.FeatureMixin.nearest_time" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">nearest_time</span><span class="p">(</span><span class="n">time</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Return a subset with the nearest time values.</p>
<p>This operation extracts a subset of values along the time axis,
which are nearest to the values specified with <code>time</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>time</code></td>
          <td>
                <code>array_like</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Time values to search for.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>caller type</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A feature, domain, or field obtained after subsetting the
caller along the time axis.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>geokube/core/feature.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">nearest_time</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="n">date</span> <span class="o">|</span> <span class="n">datetime</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a subset with the nearest time values.</span>

<span class="sd">    This operation extracts a subset of values along the time axis,</span>
<span class="sd">    which are nearest to the values specified with `time`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    time : array_like, optional</span>
<span class="sd">        Time values to search for.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    caller type</span>
<span class="sd">        A feature, domain, or field obtained after subsetting the</span>
<span class="sd">        caller along the time axis.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="p">{</span><span class="n">axis</span><span class="o">.</span><span class="n">time</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">time</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)}</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="geokube.core.feature.FeatureMixin.nearest_vertical" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">nearest_vertical</span><span class="p">(</span><span class="n">elevation</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Return the nearest vertical locations from the domain.</p>
<p>This operation is unit-aware, which means that the units do not
need to be converted before passing to the method.  If a
quantity is passed, the units are automatically adjusted.  If
just a number or array is provided, it is assumed that the units
are the same as the corresponding coordinate.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>elevation</code></td>
          <td>
                <code>array_like or <span title="geokube.core.quantity">quantity</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Vertical coordinates for subsetting.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>caller type</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A feature, domain, or field with the the nearest vertical
locations to the elevation.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>geokube/core/feature.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">nearest_vertical</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">elevation</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span> <span class="o">|</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the nearest vertical locations from the domain.</span>

<span class="sd">    This operation is unit-aware, which means that the units do not</span>
<span class="sd">    need to be converted before passing to the method.  If a</span>
<span class="sd">    quantity is passed, the units are automatically adjusted.  If</span>
<span class="sd">    just a number or array is provided, it is assumed that the units</span>
<span class="sd">    are the same as the corresponding coordinate.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    elevation : array_like or quantity</span>
<span class="sd">        Vertical coordinates for subsetting.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    caller type</span>
<span class="sd">        A feature, domain, or field with the the nearest vertical</span>
<span class="sd">        locations to the elevation.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="p">{</span><span class="n">axis</span><span class="o">.</span><span class="n">vertical</span><span class="p">:</span> <span class="n">elevation</span><span class="p">}</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="geokube.core.feature.FeatureMixin.sel" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">sel</span><span class="p">(</span><span class="n">indexers</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">xarray_kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Return a new feature, domain, or field selected by labels.</p>
<p>The subsetting operation can be done only along the dimensions.
Subsetting is unit-aware, which means that unit conversion can
be performed on the labels in the background if necesssary.
The coordinates and data variables are reduced.  The type of
the caller and other data are preserved.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>indexers</code></td>
          <td>
                <code>dict - like</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A mapping with the keys that must be the dimensional axes
and the values that represent the corresponding labels.
The values can be scalars, arrays, or slices. They can have
the units (i.e. can be instances of the class
:class:<code>pint.Quantity</code>).  If a label does not have a unit,
then it is assumed that its unit is the default unit for
the corresponding axis (key).</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>xarray_kwargs</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Keyword arguments passed to :meth:<code>xarray.Dataset.sel</code>.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>out</code></td>          <td>
                <code>caller type</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>New feature, domain, or field created as a result of
subsetting.  The type of the subsetted object is preserved.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>geokube/core/feature.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">sel</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">indexers</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="n">axis</span><span class="o">.</span><span class="n">Axis</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">xarray_kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a new feature, domain, or field selected by labels.</span>

<span class="sd">    The subsetting operation can be done only along the dimensions.</span>
<span class="sd">    Subsetting is unit-aware, which means that unit conversion can</span>
<span class="sd">    be performed on the labels in the background if necesssary.</span>
<span class="sd">    The coordinates and data variables are reduced.  The type of</span>
<span class="sd">    the caller and other data are preserved.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    indexers : dict-like, optional</span>
<span class="sd">        A mapping with the keys that must be the dimensional axes</span>
<span class="sd">        and the values that represent the corresponding labels.</span>
<span class="sd">        The values can be scalars, arrays, or slices. They can have</span>
<span class="sd">        the units (i.e. can be instances of the class</span>
<span class="sd">        :class:`pint.Quantity`).  If a label does not have a unit,</span>
<span class="sd">        then it is assumed that its unit is the default unit for</span>
<span class="sd">        the corresponding axis (key).</span>

<span class="sd">    xarray_kwargs : dict, optional</span>
<span class="sd">        Keyword arguments passed to :meth:`xarray.Dataset.sel`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    out : caller type</span>
<span class="sd">        New feature, domain, or field created as a result of</span>
<span class="sd">        subsetting.  The type of the subsetted object is preserved.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">indexers</span><span class="o">=</span><span class="n">indexers</span><span class="p">,</span> <span class="o">**</span><span class="n">xarray_kwargs</span><span class="p">)</span>
    <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_from_xarray_dataset</span><span class="p">(</span><span class="n">dset</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">out</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="geokube.core.feature.FeatureMixin.time_range" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">time_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Return a subset defined within the time bounds.</p>
<p>This operation extracts a subset of values along the time axis,
within the time interval between <code>start</code> and <code>end</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>start</code></td>
          <td>
                <code>date, datetime, or str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Time bounds.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>end</code></td>
          <td>
                <code>date, datetime, or str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Time bounds.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>caller type</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A feature, domain, or field obtained after subsetting the
caller along the time axis.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>geokube/core/feature.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">time_range</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">start</span><span class="p">:</span> <span class="n">date</span> <span class="o">|</span> <span class="n">datetime</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">end</span><span class="p">:</span> <span class="n">date</span> <span class="o">|</span> <span class="n">datetime</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a subset defined within the time bounds.</span>

<span class="sd">    This operation extracts a subset of values along the time axis,</span>
<span class="sd">    within the time interval between `start` and `end`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    start, end : date, datetime, or str, optional</span>
<span class="sd">        Time bounds.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    caller type</span>
<span class="sd">        A feature, domain, or field obtained after subsetting the</span>
<span class="sd">        caller along the time axis.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="p">{</span><span class="n">axis</span><span class="o">.</span><span class="n">time</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)}</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="geokube.core.feature.FeatureMixin.to_netcdf" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">to_netcdf</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">xarray_kwargs</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Write the contents to a netCDF file.</p>
<p>This operation extracts a subset of values along the time axis,
which are nearest to the values specified with <code>time</code>.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The path of the target netCDF file.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>**xarray_kwargs</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Extra arguments to :meth:<code>xarray.Dataset.to_netcdf</code>.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>geokube/core/feature.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_netcdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">xarray_kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Write the contents to a netCDF file.</span>

<span class="sd">    This operation extracts a subset of values along the time axis,</span>
<span class="sd">    which are nearest to the values specified with `time`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path : str</span>
<span class="sd">        The path of the target netCDF file.</span>
<span class="sd">    **xarray_kwargs : dict, optional</span>
<span class="sd">        Extra arguments to :meth:`xarray.Dataset.to_netcdf`.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span>
    <span class="n">dset</span> <span class="o">=</span> <span class="n">dset</span><span class="o">.</span><span class="n">drop_indexes</span><span class="p">(</span><span class="n">dset</span><span class="o">.</span><span class="n">xindexes</span><span class="p">)</span>

    <span class="n">coords</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">dset</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">axis_</span><span class="p">,</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">coords</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axis_</span><span class="p">,</span> <span class="n">axis</span><span class="o">.</span><span class="n">Axis</span><span class="p">):</span>
            <span class="n">axes</span><span class="p">[</span><span class="n">axis_</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">coord</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;standard_name&#39;</span><span class="p">)</span>
                <span class="ow">or</span> <span class="n">axis_</span><span class="o">.</span><span class="n">encoding</span><span class="p">[</span><span class="s1">&#39;standard_name&#39;</span><span class="p">]</span>
            <span class="p">)</span>
    <span class="n">dims</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="n">dset</span><span class="o">.</span><span class="n">dims</span><span class="p">:</span>
        <span class="n">names</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">dims</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">axis</span><span class="o">.</span><span class="n">Axis</span><span class="p">)</span>
            <span class="ow">and</span> <span class="p">(</span><span class="n">dim_name</span> <span class="o">:=</span> <span class="n">dim</span><span class="o">.</span><span class="n">encoding</span><span class="p">[</span><span class="s1">&#39;standard_name&#39;</span><span class="p">])</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">names</span>
        <span class="p">):</span>
            <span class="n">dims</span><span class="p">[</span><span class="n">dim</span><span class="p">]</span> <span class="o">=</span> <span class="n">dim_name</span>
    <span class="n">dset</span> <span class="o">=</span> <span class="n">dset</span><span class="o">.</span><span class="n">rename_vars</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span><span class="o">.</span><span class="n">swap_dims</span><span class="p">(</span><span class="n">dims</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">time_coord</span> <span class="o">:=</span> <span class="n">coords</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">axis</span><span class="o">.</span><span class="n">time</span><span class="p">))</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="ow">and</span> <span class="p">(</span>
            <span class="p">(</span><span class="n">bnds</span> <span class="o">:=</span> <span class="n">time_coord</span><span class="o">.</span><span class="n">encoding</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;bounds&#39;</span><span class="p">))</span>
            <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;time_bnds&#39;</span><span class="p">,</span> <span class="s1">&#39;time_bounds&#39;</span><span class="p">}</span>
        <span class="p">)</span>
        <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">time_coord</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">Interval</span><span class="p">)</span>
    <span class="p">):</span>
        <span class="n">inter</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">IntervalIndex</span><span class="p">(</span><span class="n">time_coord</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">())</span>
        <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">inter</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="n">inter</span><span class="o">.</span><span class="n">right</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
        <span class="n">time_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">time_coord</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">left</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
        <span class="n">time_vals</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">time_vals</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span>
        <span class="n">dset</span> <span class="o">=</span> <span class="n">dset</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span>
            <span class="n">coords</span><span class="o">=</span><span class="p">{</span>
                <span class="n">bnds</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;bnds&#39;</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="n">time_vals</span><span class="p">),</span>
                <span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span>
                    <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,),</span>
                    <span class="n">data</span><span class="o">=</span><span class="n">left</span><span class="p">,</span>
                    <span class="n">attrs</span><span class="o">=</span><span class="n">time_coord</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span>
                    <span class="n">encoding</span><span class="o">=</span><span class="n">time_coord</span><span class="o">.</span><span class="n">encoding</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="p">)</span>

    <span class="c1"># TODO: Use `itertools.chain` to create a single loop.</span>
    <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">dset</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">attrs</span> <span class="o">=</span> <span class="n">coord</span><span class="o">.</span><span class="n">attrs</span>
        <span class="k">if</span> <span class="s1">&#39;units&#39;</span> <span class="ow">in</span> <span class="n">attrs</span> <span class="ow">and</span> <span class="n">units</span><span class="p">[</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]]</span> <span class="o">==</span> <span class="n">units</span><span class="p">[</span><span class="kc">None</span><span class="p">]:</span>
            <span class="k">del</span> <span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">dset</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">attrs</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">attrs</span>
        <span class="k">if</span> <span class="s1">&#39;units&#39;</span> <span class="ow">in</span> <span class="n">attrs</span> <span class="ow">and</span> <span class="n">units</span><span class="p">[</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]]</span> <span class="o">==</span> <span class="n">units</span><span class="p">[</span><span class="kc">None</span><span class="p">]:</span>
            <span class="k">del</span> <span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span>

    <span class="n">dset</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;grid_mapping&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">gmn</span> <span class="o">:=</span> <span class="n">dset</span><span class="o">.</span><span class="n">cf</span><span class="o">.</span><span class="n">grid_mapping_names</span><span class="p">:</span>
        <span class="n">crs_var_name</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">gmn</span><span class="o">.</span><span class="n">values</span><span class="p">()))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">dset</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">var</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;grid_mapping&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">var</span><span class="o">.</span><span class="n">encoding</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;grid_mapping&#39;</span><span class="p">,</span> <span class="n">crs_var_name</span><span class="p">)</span>

    <span class="c1"># TODO: Improve squeezing.</span>
    <span class="n">dset</span> <span class="o">=</span> <span class="n">dset</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>

    <span class="n">dset</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">xarray_kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="geokube.core.feature.GridFeature" class="doc doc-heading">
          <code>GridFeature</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="geokube.core.feature.Feature" href="#geokube.core.feature.Feature">Feature</a></code></p>

  
      <p>Feature defined on a gridded domain.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ds</code></td>
          <td>
                <code>xarray dataset</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>CF-compliant dataset with all the inputs.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cf_mappings</code></td>
          <td>
                <code>dict_like</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>CF-compliant hints</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.GridFeature.coords" href="#geokube.core.feature.FeatureMixin.coords">coords</a></code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return the coordinates of a domain, with their units.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.GridFeature.coord_system" href="#geokube.core.feature.FeatureMixin.coord_system">coord_system</a></code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="geokube.core.coord_system.CoordinateSystem" href="coord_system.html#geokube.core.coord_system.CoordinateSystem">CoordinateSystem</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return the coordinate system of a domain.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.GridFeature.crs" href="#geokube.core.feature.FeatureMixin.crs">crs</a></code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="geokube.core.crs.CRS" href="crs.html#geokube.core.crs.CRS">CRS</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return the coordinate reference system of a domain.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.GridFeature.dim_axes" href="#geokube.core.feature.FeatureMixin.dim_axes">dim_axes</a></code></td>
          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return the dimension axes of a domain.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.GridFeature.dim_coords" href="#geokube.core.feature.FeatureMixin.dim_coords">dim_coords</a></code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return the dimension coordinates of a domain.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.GridFeature.aux_axes" href="#geokube.core.feature.FeatureMixin.aux_axes">aux_axes</a></code></td>
          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return the auxiliary axes of a domain.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.GridFeature.aux_coords" href="#geokube.core.feature.FeatureMixin.aux_coords">aux_coords</a></code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return the auxiliary coordinates of a domain.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Methods:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.GridFeature.sel" href="#geokube.core.feature.FeatureMixin.sel">sel</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return a new feature, domain, or field selected by labels.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.GridFeature.isel" href="#geokube.core.feature.FeatureMixin.isel">isel</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return a new feature, domain, or field selected by indexes.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.GridFeature.bounding_box" href="#geokube.core.feature.FeatureMixin.bounding_box">bounding_box</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return a subset defined with a bounding box.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.GridFeature.nearest_horizontal" href="#geokube.core.feature.GridFeature.nearest_horizontal">nearest_horizontal</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return the nearest horizontal locations from the domain.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.GridFeature.nearest_vertical" href="#geokube.core.feature.FeatureMixin.nearest_vertical">nearest_vertical</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return the nearest vertical locations from the domain.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.GridFeature.time_range" href="#geokube.core.feature.FeatureMixin.time_range">time_range</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return a subset defined within the time bounds.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.GridFeature.nearest_time" href="#geokube.core.feature.FeatureMixin.nearest_time">nearest_time</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return a subset with the nearest time values.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.GridFeature.latest" href="#geokube.core.feature.FeatureMixin.latest">latest</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return a subset with just the latest (largest) time value.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.GridFeature.as_points" href="#geokube.core.feature.GridFeature.as_points">as_points</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return points representation of the data and coordinates.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.GridFeature.to_netcdf" href="#geokube.core.feature.FeatureMixin.to_netcdf">to_netcdf</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Write the contents to a netCDF file.</p>
              </div>
            </td>
          </tr>
    </tbody>
  </table>

<details class="see-also" open>
  <summary>See Also</summary>
  <p>:class:<code>geokube.core.feature.PointsFeature</code> :
    Feature defined on a point domain.
:class:<code>geokube.core.feature.ProfilesFeature</code> :
    Feature defined on a profile domain.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>geokube/core/feature.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">GridFeature</span><span class="p">(</span><span class="n">Feature</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Feature defined on a gridded domain.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ds : xarray dataset</span>
<span class="sd">        CF-compliant dataset with all the inputs.</span>
<span class="sd">    cf_mappings : dict_like</span>
<span class="sd">        CF-compliant hints</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    coords : dict</span>
<span class="sd">        Return the coordinates of a domain, with their units.</span>
<span class="sd">    coord_system : CoordinateSystem</span>
<span class="sd">        Return the coordinate system of a domain.</span>
<span class="sd">    crs : CRS</span>
<span class="sd">        Return the coordinate reference system of a domain.</span>
<span class="sd">    dim_axes : tuple</span>
<span class="sd">        Return the dimension axes of a domain.</span>
<span class="sd">    dim_coords : dict</span>
<span class="sd">        Return the dimension coordinates of a domain.</span>
<span class="sd">    aux_axes : tuple</span>
<span class="sd">        Return the auxiliary axes of a domain.</span>
<span class="sd">    aux_coords : dict</span>
<span class="sd">        Return the auxiliary coordinates of a domain.</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    sel(indexers, **xarray_kwargs)</span>
<span class="sd">        Return a new feature, domain, or field selected by labels.</span>
<span class="sd">    isel(indexers, **xarray_kwargs)</span>
<span class="sd">        Return a new feature, domain, or field selected by indexes.</span>
<span class="sd">    bounding_box(south, north, west, east, bottom, top)</span>
<span class="sd">        Return a subset defined with a bounding box.</span>
<span class="sd">    nearest_horizontal(latitude, longitude)</span>
<span class="sd">        Return the nearest horizontal locations from the domain.</span>
<span class="sd">    nearest_vertical(elevation)</span>
<span class="sd">        Return the nearest vertical locations from the domain.</span>
<span class="sd">    time_range(start, end)</span>
<span class="sd">        Return a subset defined within the time bounds.</span>
<span class="sd">    nearest_time(time)</span>
<span class="sd">        Return a subset with the nearest time values.</span>
<span class="sd">    latest()</span>
<span class="sd">        Return a subset with just the latest (largest) time value.</span>
<span class="sd">    as_points()</span>
<span class="sd">        Return points representation of the data and coordinates.</span>
<span class="sd">    to_netcdf(path, **xarray_kwargs)</span>
<span class="sd">        Write the contents to a netCDF file.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    :class:`geokube.core.feature.PointsFeature` :</span>
<span class="sd">        Feature defined on a point domain.</span>
<span class="sd">    :class:`geokube.core.feature.ProfilesFeature` :</span>
<span class="sd">        Feature defined on a profile domain.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_DIMS_&#39;</span><span class="p">,)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ds</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span>
        <span class="n">cf_mappings</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># this could be used to pass CF compliant hints</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">ds</span><span class="o">=</span><span class="n">ds</span><span class="p">,</span> <span class="n">cf_mappings</span><span class="o">=</span><span class="n">cf_mappings</span><span class="p">)</span>        

        <span class="c1"># TODO: Check if it is a Grid Feature ???</span>

        <span class="c1"># self._dims = </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_DIMS_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coord_system</span><span class="o">.</span><span class="n">dim_axes</span> <span class="c1"># this depends on the Coordinate System</span>

        <span class="c1"># for axis_ in self._DIMS_:</span>
        <span class="c1">#     if axis_ not in self._dset.xindexes:</span>
        <span class="c1">#         self._dset = self._dset.set_xindex(axis_)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span><span class="o">.</span><span class="n">drop_indexes</span><span class="p">(</span>
            <span class="n">coord_names</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dset</span><span class="o">.</span><span class="n">xindexes</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">axis_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_DIMS_</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span><span class="o">.</span><span class="n">set_xindex</span><span class="p">(</span>
                <span class="n">axis_</span><span class="p">,</span> <span class="n">indexes</span><span class="o">.</span><span class="n">OneDimPandasIndex</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="p">{</span><span class="n">axis</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span> <span class="n">axis</span><span class="o">.</span><span class="n">longitude</span><span class="p">}</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aux_axes</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span><span class="o">.</span><span class="n">set_xindex</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">aux_axes</span><span class="p">,</span> <span class="n">indexes</span><span class="o">.</span><span class="n">TwoDimHorGridIndex</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">nearest_horizontal</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">latitude</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span> <span class="o">|</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">,</span>
        <span class="n">longitude</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span> <span class="o">|</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">,</span>
        <span class="n">as_points</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span> <span class="o">|</span> <span class="n">PointsFeature</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the nearest horizontal locations from the domain.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        latitude, longitude : array_like or quantity</span>
<span class="sd">            Horizontal coordinates for subsetting.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        caller type or PointsFeature</span>
<span class="sd">            A feature, domain, or field with the the nearest horizontal</span>
<span class="sd">            locations from the domain to all latitude-longitude pairs.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span><span class="p">[</span><span class="n">axis</span><span class="o">.</span><span class="n">latitude</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span><span class="p">[</span><span class="n">axis</span><span class="o">.</span><span class="n">longitude</span><span class="p">]</span>
        <span class="n">lat_vals</span><span class="p">,</span> <span class="n">lon_vals</span> <span class="o">=</span> <span class="n">lat</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="n">lon</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span> <span class="n">Geodetic</span><span class="p">):</span>
            <span class="n">lat_vals</span><span class="p">,</span> <span class="n">lon_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lat_vals</span><span class="p">,</span> <span class="n">lon_vals</span><span class="p">,</span> <span class="n">indexing</span><span class="o">=</span><span class="s1">&#39;ij&#39;</span><span class="p">)</span>
        <span class="n">dims</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">dim_Y_axis</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">dim_X_axis</span><span class="p">)</span>

        <span class="n">lat_labels</span> <span class="o">=</span> <span class="n">get_magnitude</span><span class="p">(</span><span class="n">latitude</span><span class="p">,</span> <span class="n">lat</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">])</span>
        <span class="n">lon_labels</span> <span class="o">=</span> <span class="n">get_magnitude</span><span class="p">(</span><span class="n">longitude</span><span class="p">,</span> <span class="n">lon</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">])</span>

        <span class="n">idx</span> <span class="o">=</span> <span class="n">get_array_indexer</span><span class="p">(</span>
            <span class="p">[</span><span class="n">lat_vals</span><span class="p">,</span> <span class="n">lon_vals</span><span class="p">],</span>
            <span class="p">[</span><span class="n">lat_labels</span><span class="p">,</span> <span class="n">lon_labels</span><span class="p">],</span>
            <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span>
            <span class="n">tolerance</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span>
            <span class="n">return_all</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>
        <span class="n">result_idx</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dims</span><span class="p">,</span> <span class="n">idx</span><span class="p">))</span>

        <span class="c1"># Example:</span>
        <span class="c1"># lat_vals = np.array([[30., 31.], [35., 36.], [40., 41.]])</span>
        <span class="c1"># lon_vals = np.array([[10., 11.], [15., 16.], [20., 21.]])</span>
        <span class="c1"># lat_labels = [29, 42]</span>
        <span class="c1"># lon_labels = [5, 18]</span>
        <span class="c1"># idx:</span>
        <span class="c1"># (array([0, 2]), array([0, 0]))</span>
        <span class="c1"># result_idx:</span>
        <span class="c1"># {axis.grid_latitude: array([0, 2]),</span>
        <span class="c1">#  axis.grid_longitude: array([0, 0])}</span>

        <span class="n">dset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">indexers</span><span class="o">=</span><span class="n">result_idx</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_from_xarray_dataset</span><span class="p">(</span><span class="n">dset</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">as_points</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">as_points</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">as_points</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PointsFeature</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return points representation of the data and coordinates.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        PointsFeature</span>
<span class="sd">            Points feature with the same data and coordinates.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">PointsFeature</span><span class="o">.</span><span class="n">_from_xarray_dataset</span><span class="p">(</span><span class="n">_as_points_dataset</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="geokube.core.feature.GridFeature.as_points" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">as_points</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Return points representation of the data and coordinates.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="geokube.core.feature.PointsFeature" href="#geokube.core.feature.PointsFeature">PointsFeature</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Points feature with the same data and coordinates.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>geokube/core/feature.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">as_points</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PointsFeature</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return points representation of the data and coordinates.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    PointsFeature</span>
<span class="sd">        Points feature with the same data and coordinates.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">PointsFeature</span><span class="o">.</span><span class="n">_from_xarray_dataset</span><span class="p">(</span><span class="n">_as_points_dataset</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="geokube.core.feature.GridFeature.nearest_horizontal" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">nearest_horizontal</span><span class="p">(</span><span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span><span class="p">,</span> <span class="n">as_points</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Return the nearest horizontal locations from the domain.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>latitude</code></td>
          <td>
                <code>array_like or <span title="geokube.core.quantity">quantity</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Horizontal coordinates for subsetting.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>longitude</code></td>
          <td>
                <code>array_like or <span title="geokube.core.quantity">quantity</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Horizontal coordinates for subsetting.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>caller type or PointsFeature</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A feature, domain, or field with the the nearest horizontal
locations from the domain to all latitude-longitude pairs.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>geokube/core/feature.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">nearest_horizontal</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">latitude</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span> <span class="o">|</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">,</span>
    <span class="n">longitude</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span> <span class="o">|</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span><span class="p">,</span>
    <span class="n">as_points</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span> <span class="o">|</span> <span class="n">PointsFeature</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the nearest horizontal locations from the domain.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    latitude, longitude : array_like or quantity</span>
<span class="sd">        Horizontal coordinates for subsetting.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    caller type or PointsFeature</span>
<span class="sd">        A feature, domain, or field with the the nearest horizontal</span>
<span class="sd">        locations from the domain to all latitude-longitude pairs.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span><span class="p">[</span><span class="n">axis</span><span class="o">.</span><span class="n">latitude</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span><span class="p">[</span><span class="n">axis</span><span class="o">.</span><span class="n">longitude</span><span class="p">]</span>
    <span class="n">lat_vals</span><span class="p">,</span> <span class="n">lon_vals</span> <span class="o">=</span> <span class="n">lat</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="n">lon</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="p">,</span> <span class="n">Geodetic</span><span class="p">):</span>
        <span class="n">lat_vals</span><span class="p">,</span> <span class="n">lon_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">lat_vals</span><span class="p">,</span> <span class="n">lon_vals</span><span class="p">,</span> <span class="n">indexing</span><span class="o">=</span><span class="s1">&#39;ij&#39;</span><span class="p">)</span>
    <span class="n">dims</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">dim_Y_axis</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">dim_X_axis</span><span class="p">)</span>

    <span class="n">lat_labels</span> <span class="o">=</span> <span class="n">get_magnitude</span><span class="p">(</span><span class="n">latitude</span><span class="p">,</span> <span class="n">lat</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">])</span>
    <span class="n">lon_labels</span> <span class="o">=</span> <span class="n">get_magnitude</span><span class="p">(</span><span class="n">longitude</span><span class="p">,</span> <span class="n">lon</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">])</span>

    <span class="n">idx</span> <span class="o">=</span> <span class="n">get_array_indexer</span><span class="p">(</span>
        <span class="p">[</span><span class="n">lat_vals</span><span class="p">,</span> <span class="n">lon_vals</span><span class="p">],</span>
        <span class="p">[</span><span class="n">lat_labels</span><span class="p">,</span> <span class="n">lon_labels</span><span class="p">],</span>
        <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span>
        <span class="n">tolerance</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span>
        <span class="n">return_all</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>
    <span class="n">result_idx</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">dims</span><span class="p">,</span> <span class="n">idx</span><span class="p">))</span>

    <span class="c1"># Example:</span>
    <span class="c1"># lat_vals = np.array([[30., 31.], [35., 36.], [40., 41.]])</span>
    <span class="c1"># lon_vals = np.array([[10., 11.], [15., 16.], [20., 21.]])</span>
    <span class="c1"># lat_labels = [29, 42]</span>
    <span class="c1"># lon_labels = [5, 18]</span>
    <span class="c1"># idx:</span>
    <span class="c1"># (array([0, 2]), array([0, 0]))</span>
    <span class="c1"># result_idx:</span>
    <span class="c1"># {axis.grid_latitude: array([0, 2]),</span>
    <span class="c1">#  axis.grid_longitude: array([0, 0])}</span>

    <span class="n">dset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">indexers</span><span class="o">=</span><span class="n">result_idx</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_from_xarray_dataset</span><span class="p">(</span><span class="n">dset</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">as_points</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">as_points</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="geokube.core.feature.PointsFeature" class="doc doc-heading">
          <code>PointsFeature</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="geokube.core.feature.Feature" href="#geokube.core.feature.Feature">Feature</a></code></p>

  
      <p>Feature defined on a point domain.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ds</code></td>
          <td>
                <code>xarray dataset</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>CF-compliant dataset with all the inputs.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cf_mappings</code></td>
          <td>
                <code>dict_like</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>CF-compliant hints</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.PointsFeature.coords" href="#geokube.core.feature.FeatureMixin.coords">coords</a></code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return the coordinates of a domain, with their units.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.PointsFeature.coord_system" href="#geokube.core.feature.FeatureMixin.coord_system">coord_system</a></code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="geokube.core.coord_system.CoordinateSystem" href="coord_system.html#geokube.core.coord_system.CoordinateSystem">CoordinateSystem</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return the coordinate system of a domain.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.PointsFeature.crs" href="#geokube.core.feature.FeatureMixin.crs">crs</a></code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="geokube.core.crs.CRS" href="crs.html#geokube.core.crs.CRS">CRS</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return the coordinate reference system of a domain.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.PointsFeature.dim_axes" href="#geokube.core.feature.FeatureMixin.dim_axes">dim_axes</a></code></td>
          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return the dimension axes of a domain.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.PointsFeature.dim_coords" href="#geokube.core.feature.FeatureMixin.dim_coords">dim_coords</a></code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return the dimension coordinates of a domain.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.PointsFeature.aux_axes" href="#geokube.core.feature.FeatureMixin.aux_axes">aux_axes</a></code></td>
          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return the auxiliary axes of a domain.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.PointsFeature.aux_coords" href="#geokube.core.feature.FeatureMixin.aux_coords">aux_coords</a></code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return the auxiliary coordinates of a domain.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.PointsFeature.number_of_points" href="#geokube.core.feature.PointsFeature.number_of_points">number_of_points</a></code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of points.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Methods:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.PointsFeature.sel" href="#geokube.core.feature.FeatureMixin.sel">sel</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return a new feature, domain, or field selected by labels.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.PointsFeature.isel" href="#geokube.core.feature.FeatureMixin.isel">isel</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return a new feature, domain, or field selected by indexes.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.PointsFeature.bounding_box" href="#geokube.core.feature.FeatureMixin.bounding_box">bounding_box</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return a subset defined with a bounding box.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.PointsFeature.nearest_horizontal" href="#geokube.core.feature.FeatureMixin.nearest_horizontal">nearest_horizontal</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return the nearest horizontal locations from the domain.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.PointsFeature.nearest_vertical" href="#geokube.core.feature.FeatureMixin.nearest_vertical">nearest_vertical</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return the nearest vertical locations from the domain.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.PointsFeature.time_range" href="#geokube.core.feature.FeatureMixin.time_range">time_range</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return a subset defined within the time bounds.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.PointsFeature.nearest_time" href="#geokube.core.feature.FeatureMixin.nearest_time">nearest_time</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return a subset with the nearest time values.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.PointsFeature.latest" href="#geokube.core.feature.FeatureMixin.latest">latest</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return a subset with just the latest (largest) time value.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.PointsFeature.to_netcdf" href="#geokube.core.feature.FeatureMixin.to_netcdf">to_netcdf</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Write the contents to a netCDF file.</p>
              </div>
            </td>
          </tr>
    </tbody>
  </table>

<details class="see-also" open>
  <summary>See Also</summary>
  <p>:class:<code>geokube.core.feature.ProfilesFeature</code> :
    Feature defined on a profile domain.
:class:<code>geokube.core.feature.GridFeature</code> :
    Feature defined on a gridded domain.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>geokube/core/feature.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">PointsFeature</span><span class="p">(</span><span class="n">Feature</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Feature defined on a point domain.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ds : xarray dataset</span>
<span class="sd">        CF-compliant dataset with all the inputs.</span>
<span class="sd">    cf_mappings : dict_like</span>
<span class="sd">        CF-compliant hints</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    coords : dict</span>
<span class="sd">        Return the coordinates of a domain, with their units.</span>
<span class="sd">    coord_system : CoordinateSystem</span>
<span class="sd">        Return the coordinate system of a domain.</span>
<span class="sd">    crs : CRS</span>
<span class="sd">        Return the coordinate reference system of a domain.</span>
<span class="sd">    dim_axes : tuple</span>
<span class="sd">        Return the dimension axes of a domain.</span>
<span class="sd">    dim_coords : dict</span>
<span class="sd">        Return the dimension coordinates of a domain.</span>
<span class="sd">    aux_axes : tuple</span>
<span class="sd">        Return the auxiliary axes of a domain.</span>
<span class="sd">    aux_coords : dict</span>
<span class="sd">        Return the auxiliary coordinates of a domain.</span>
<span class="sd">    number_of_points : int</span>
<span class="sd">        The number of points.</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    sel(indexers, **xarray_kwargs)</span>
<span class="sd">        Return a new feature, domain, or field selected by labels.</span>
<span class="sd">    isel(indexers, **xarray_kwargs)</span>
<span class="sd">        Return a new feature, domain, or field selected by indexes.</span>
<span class="sd">    bounding_box(south, north, west, east, bottom, top)</span>
<span class="sd">        Return a subset defined with a bounding box.</span>
<span class="sd">    nearest_horizontal(latitude, longitude)</span>
<span class="sd">        Return the nearest horizontal locations from the domain.</span>
<span class="sd">    nearest_vertical(elevation)</span>
<span class="sd">        Return the nearest vertical locations from the domain.</span>
<span class="sd">    time_range(start, end)</span>
<span class="sd">        Return a subset defined within the time bounds.</span>
<span class="sd">    nearest_time(time)</span>
<span class="sd">        Return a subset with the nearest time values.</span>
<span class="sd">    latest()</span>
<span class="sd">        Return a subset with just the latest (largest) time value.</span>
<span class="sd">    to_netcdf(path, **xarray_kwargs)</span>
<span class="sd">        Write the contents to a netCDF file.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    :class:`geokube.core.feature.ProfilesFeature` :</span>
<span class="sd">        Feature defined on a profile domain.</span>
<span class="sd">    :class:`geokube.core.feature.GridFeature` :</span>
<span class="sd">        Feature defined on a gridded domain.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_n_points&#39;</span><span class="p">,)</span>
    <span class="n">_DIMS_</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_points&#39;</span><span class="p">,)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ds</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span> <span class="c1"># This dataset should check for _DIMS_ that is points</span>
        <span class="n">cf_mappings</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># this could be used to pass CF compliant hints</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="c1"># TODO: check if ds is a Points Features -&gt; _points dim should exist</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">ds</span><span class="o">=</span><span class="n">ds</span><span class="p">,</span> <span class="n">cf_mappings</span><span class="o">=</span><span class="n">cf_mappings</span><span class="p">)</span>

        <span class="n">hor_axes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">axis_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coord_system</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">axis_</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">hor_axes</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span><span class="o">.</span><span class="n">set_xindex</span><span class="p">(</span><span class="n">axis_</span><span class="p">,</span> <span class="n">indexes</span><span class="o">.</span><span class="n">OneDimIndex</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span><span class="o">.</span><span class="n">set_xindex</span><span class="p">(</span>
            <span class="p">[</span><span class="n">axis</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span> <span class="n">axis</span><span class="o">.</span><span class="n">longitude</span><span class="p">],</span> <span class="n">indexes</span><span class="o">.</span><span class="n">TwoDimHorPointsIndex</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">number_of_points</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the number of points.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span><span class="p">[</span><span class="s1">&#39;_points&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">size</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="geokube.core.feature.PointsFeature.number_of_points" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">number_of_points</span><span class="p">:</span> <span class="nb">int</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns the number of points.</p>
  </div>

</div>





  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="geokube.core.feature.ProfilesFeature" class="doc doc-heading">
          <code>ProfilesFeature</code>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="geokube.core.feature.Feature" href="#geokube.core.feature.Feature">Feature</a></code></p>

  
      <p>Feature defined on a profile domain.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>ds</code></td>
          <td>
                <code>xarray dataset</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>CF-compliant dataset with all the inputs.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>cf_mappings</code></td>
          <td>
                <code>dict_like</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>CF-compliant hints</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.ProfilesFeature.coords" href="#geokube.core.feature.FeatureMixin.coords">coords</a></code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return the coordinates of a domain, with their units.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.ProfilesFeature.coord_system" href="#geokube.core.feature.FeatureMixin.coord_system">coord_system</a></code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="geokube.core.coord_system.CoordinateSystem" href="coord_system.html#geokube.core.coord_system.CoordinateSystem">CoordinateSystem</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return the coordinate system of a domain.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.ProfilesFeature.crs" href="#geokube.core.feature.FeatureMixin.crs">crs</a></code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="geokube.core.crs.CRS" href="crs.html#geokube.core.crs.CRS">CRS</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return the coordinate reference system of a domain.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.ProfilesFeature.dim_axes" href="#geokube.core.feature.FeatureMixin.dim_axes">dim_axes</a></code></td>
          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return the dimension axes of a domain.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.ProfilesFeature.dim_coords" href="#geokube.core.feature.FeatureMixin.dim_coords">dim_coords</a></code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return the dimension coordinates of a domain.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.ProfilesFeature.aux_axes" href="#geokube.core.feature.FeatureMixin.aux_axes">aux_axes</a></code></td>
          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return the auxiliary axes of a domain.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.ProfilesFeature.aux_coords" href="#geokube.core.feature.FeatureMixin.aux_coords">aux_coords</a></code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return the auxiliary coordinates of a domain.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.ProfilesFeature.number_of_profiles" href="#geokube.core.feature.ProfilesFeature.number_of_profiles">number_of_profiles</a></code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of profiles in a domain or field.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.ProfilesFeature.number_of_levels" href="#geokube.core.feature.ProfilesFeature.number_of_levels">number_of_levels</a></code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of levels in a domain or field.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Methods:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.ProfilesFeature.sel" href="#geokube.core.feature.FeatureMixin.sel">sel</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return a new feature, domain, or field selected by labels.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.ProfilesFeature.isel" href="#geokube.core.feature.FeatureMixin.isel">isel</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return a new feature, domain, or field selected by indexes.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.ProfilesFeature.bounding_box" href="#geokube.core.feature.ProfilesFeature.bounding_box">bounding_box</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return a subset defined with a bounding box.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.ProfilesFeature.nearest_horizontal" href="#geokube.core.feature.FeatureMixin.nearest_horizontal">nearest_horizontal</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return the nearest horizontal locations from the domain.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.ProfilesFeature.nearest_vertical" href="#geokube.core.feature.ProfilesFeature.nearest_vertical">nearest_vertical</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return the nearest vertical locations from the domain.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.ProfilesFeature.time_range" href="#geokube.core.feature.FeatureMixin.time_range">time_range</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return a subset defined within the time bounds.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.ProfilesFeature.nearest_time" href="#geokube.core.feature.FeatureMixin.nearest_time">nearest_time</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return a subset with the nearest time values.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.ProfilesFeature.latest" href="#geokube.core.feature.FeatureMixin.latest">latest</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return a subset with just the latest (largest) time value.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.ProfilesFeature.as_points" href="#geokube.core.feature.ProfilesFeature.as_points">as_points</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Return points representation of the data and coordinates.</p>
              </div>
            </td>
          </tr>
          <tr>
            <td><code><a class="autorefs autorefs-internal" title="geokube.core.feature.ProfilesFeature.to_netcdf" href="#geokube.core.feature.FeatureMixin.to_netcdf">to_netcdf</a></code></td>
            <td>
              <div class="doc-md-description">
                <p>Write the contents to a netCDF file.</p>
              </div>
            </td>
          </tr>
    </tbody>
  </table>

<details class="see-also" open>
  <summary>See Also</summary>
  <p>:class:<code>geokube.core.feature.PointsFeature</code> :
    Feature defined on a point domain.
:class:<code>geokube.core.feature.GridFeature</code> :
    Feature defined on a gridded domain.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>geokube/core/feature.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ProfilesFeature</span><span class="p">(</span><span class="n">Feature</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Feature defined on a profile domain.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ds : xarray dataset</span>
<span class="sd">        CF-compliant dataset with all the inputs.</span>
<span class="sd">    cf_mappings : dict_like</span>
<span class="sd">        CF-compliant hints</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    coords : dict</span>
<span class="sd">        Return the coordinates of a domain, with their units.</span>
<span class="sd">    coord_system : CoordinateSystem</span>
<span class="sd">        Return the coordinate system of a domain.</span>
<span class="sd">    crs : CRS</span>
<span class="sd">        Return the coordinate reference system of a domain.</span>
<span class="sd">    dim_axes : tuple</span>
<span class="sd">        Return the dimension axes of a domain.</span>
<span class="sd">    dim_coords : dict</span>
<span class="sd">        Return the dimension coordinates of a domain.</span>
<span class="sd">    aux_axes : tuple</span>
<span class="sd">        Return the auxiliary axes of a domain.</span>
<span class="sd">    aux_coords : dict</span>
<span class="sd">        Return the auxiliary coordinates of a domain.</span>
<span class="sd">    number_of_profiles : int</span>
<span class="sd">        The number of profiles in a domain or field.</span>
<span class="sd">    number_of_levels : int</span>
<span class="sd">        The number of levels in a domain or field.</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    sel(indexers, **xarray_kwargs)</span>
<span class="sd">        Return a new feature, domain, or field selected by labels.</span>
<span class="sd">    isel(indexers, **xarray_kwargs)</span>
<span class="sd">        Return a new feature, domain, or field selected by indexes.</span>
<span class="sd">    bounding_box(south, north, west, east, bottom, top)</span>
<span class="sd">        Return a subset defined with a bounding box.</span>
<span class="sd">    nearest_horizontal(latitude, longitude)</span>
<span class="sd">        Return the nearest horizontal locations from the domain.</span>
<span class="sd">    nearest_vertical(elevation)</span>
<span class="sd">        Return the nearest vertical locations from the domain.</span>
<span class="sd">    time_range(start, end)</span>
<span class="sd">        Return a subset defined within the time bounds.</span>
<span class="sd">    nearest_time(time)</span>
<span class="sd">        Return a subset with the nearest time values.</span>
<span class="sd">    latest()</span>
<span class="sd">        Return a subset with just the latest (largest) time value.</span>
<span class="sd">    as_points()</span>
<span class="sd">        Return points representation of the data and coordinates.</span>
<span class="sd">    to_netcdf(path, **xarray_kwargs)</span>
<span class="sd">        Write the contents to a netCDF file.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    :class:`geokube.core.feature.PointsFeature` :</span>
<span class="sd">        Feature defined on a point domain.</span>
<span class="sd">    :class:`geokube.core.feature.GridFeature` :</span>
<span class="sd">        Feature defined on a gridded domain.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_n_profiles&#39;</span><span class="p">,</span> <span class="s1">&#39;_n_levels&#39;</span><span class="p">)</span>
    <span class="n">_DIMS_</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_profiles&#39;</span><span class="p">,</span> <span class="s1">&#39;_levels&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ds</span><span class="p">:</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">,</span>
        <span class="n">cf_mappings</span><span class="p">:</span> <span class="n">Mapping</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># this could be used to pass CF compliant hints</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="c1"># TODO: check if it is a profile features (_profiles and _levels dims should exist)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">ds</span><span class="o">=</span><span class="n">ds</span><span class="p">,</span>
            <span class="n">cf_mappings</span><span class="o">=</span><span class="n">cf_mappings</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">axis_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">coord_system</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">axis_</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coord_system</span><span class="o">.</span><span class="n">spatial</span><span class="o">.</span><span class="n">axes</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span><span class="o">.</span><span class="n">set_xindex</span><span class="p">(</span><span class="n">axis_</span><span class="p">,</span> <span class="n">indexes</span><span class="o">.</span><span class="n">OneDimIndex</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span><span class="o">.</span><span class="n">set_xindex</span><span class="p">(</span>
            <span class="p">[</span><span class="n">axis</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span> <span class="n">axis</span><span class="o">.</span><span class="n">longitude</span><span class="p">],</span> <span class="n">indexes</span><span class="o">.</span><span class="n">TwoDimHorPointsIndex</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span><span class="o">.</span><span class="n">set_xindex</span><span class="p">(</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">vertical</span><span class="p">,</span> <span class="n">indexes</span><span class="o">.</span><span class="n">TwoDimVertProfileIndex</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">number_of_profiles</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the number of profiles in a domain or field.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span><span class="p">[</span><span class="s1">&#39;_profiles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">size</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">number_of_levels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the number of levels in a domain or field.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span><span class="p">[</span><span class="s1">&#39;_levels&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">size</span>

    <span class="k">def</span> <span class="nf">bounding_box</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">south</span><span class="p">:</span> <span class="n">Number</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">north</span><span class="p">:</span> <span class="n">Number</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">west</span><span class="p">:</span> <span class="n">Number</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">east</span><span class="p">:</span> <span class="n">Number</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">bottom</span><span class="p">:</span> <span class="n">Number</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">top</span><span class="p">:</span> <span class="n">Number</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a subset defined with a bounding box.</span>

<span class="sd">        This operation extracts a subset of values within a bounding</span>
<span class="sd">        box specified with the parameters north, south, east, and west.</span>
<span class="sd">        It is unit-aware, which means that the units do not need to be</span>
<span class="sd">        converted before passing to the method.  If a quantity is</span>
<span class="sd">        passed, the units are automatically adjusted.  If just a number</span>
<span class="sd">        is provided, it is assumed that the units are the same as the</span>
<span class="sd">        corresponding coordinate.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        south, north, west, east : number or quantity, optional</span>
<span class="sd">            Horizontal bounds.</span>
<span class="sd">        bottom, top : number or quantity, optional</span>
<span class="sd">            Vertical bounds.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        feature : caller type</span>
<span class="sd">            A feature, domain, or field obtained after subsetting the</span>
<span class="sd">            caller.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">h_idx</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">latitude</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="n">south</span><span class="p">,</span> <span class="n">north</span><span class="p">),</span>
            <span class="n">axis</span><span class="o">.</span><span class="n">longitude</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="n">west</span><span class="p">,</span> <span class="n">east</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="n">feature</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">h_idx</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">bottom</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">top</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="c1"># TODO: Try to move this functionality to</span>
            <span class="c1"># `indexes.TwoDimHorPointsIndex.sel`.</span>
            <span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;&#39;bounding_box&#39; loads in memory and makes a copy of the data &quot;</span>
                <span class="s2">&quot;and vertical coordinate when &#39;bottom&#39; or &#39;top&#39; is not &#39;None&#39;&quot;</span>
            <span class="p">)</span>
            <span class="c1"># TODO: Make `vert_axis` the actual vertical axis from the</span>
            <span class="c1"># coordinates.</span>
            <span class="n">v_slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">bottom</span><span class="p">,</span> <span class="n">top</span><span class="p">)</span>
            <span class="n">v_idx</span> <span class="o">=</span> <span class="p">{</span><span class="n">axis</span><span class="o">.</span><span class="n">vertical</span><span class="p">:</span> <span class="n">v_slice</span><span class="p">}</span>
            <span class="n">new_data</span> <span class="o">=</span> <span class="n">feature</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">v_idx</span><span class="p">)</span><span class="o">.</span><span class="n">_dset</span>
            <span class="n">new_data</span> <span class="o">=</span> <span class="n">new_data</span><span class="o">.</span><span class="n">drop_indexes</span><span class="p">(</span>
                <span class="n">coord_names</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">new_data</span><span class="o">.</span><span class="n">xindexes</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="p">)</span>
            <span class="n">vert</span> <span class="o">=</span> <span class="n">new_data</span><span class="p">[</span><span class="n">axis</span><span class="o">.</span><span class="n">vertical</span><span class="p">]</span>
            <span class="n">vert_mag</span><span class="p">,</span> <span class="n">vert_units</span> <span class="o">=</span> <span class="n">vert</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="n">vert</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">get_indexer</span><span class="p">(</span>
                <span class="p">[</span><span class="n">vert_mag</span><span class="p">],</span> <span class="p">[</span><span class="n">get_magnitude</span><span class="p">(</span><span class="n">v_slice</span><span class="p">,</span> <span class="n">vert_units</span><span class="p">)]</span>
            <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">masked_vert</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">vert_mag</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
            <span class="n">new_data</span><span class="p">[</span><span class="n">axis</span><span class="o">.</span><span class="n">vertical</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[:]</span> <span class="o">=</span> <span class="n">masked_vert</span>
            <span class="k">for</span> <span class="n">darr</span> <span class="ow">in</span> <span class="n">new_data</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="n">mag</span> <span class="o">=</span> <span class="n">darr</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
                <span class="n">masked_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">mag</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
                <span class="n">darr</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[:]</span> <span class="o">=</span> <span class="n">masked_data</span>
            <span class="n">feature</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_from_xarray_dataset</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">feature</span>

    <span class="k">def</span> <span class="nf">nearest_vertical</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">elevation</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span> <span class="o">|</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the nearest vertical locations from the domain.</span>

<span class="sd">        This operation is unit-aware, which means that the units do not</span>
<span class="sd">        need to be converted before passing to the method.  If a</span>
<span class="sd">        quantity is passed, the units are automatically adjusted.  If</span>
<span class="sd">        just a number or array is provided, it is assumed that the units</span>
<span class="sd">        are the same as the corresponding coordinate.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        elevation : array_like or quantity</span>
<span class="sd">            Vertical coordinates for subsetting.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        caller type</span>
<span class="sd">            A feature, domain, or field with the the nearest vertical</span>
<span class="sd">            locations to the elevation.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO: Try to move this functionality to</span>
        <span class="c1"># `indexes.TwoDimHorPointsIndex.sel`.</span>
        <span class="n">dset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span>
        <span class="n">new_coords</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">axis_</span><span class="p">:</span> <span class="n">coord</span><span class="o">.</span><span class="n">variable</span> <span class="k">for</span> <span class="n">axis_</span><span class="p">,</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">dset</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="c1"># NOTE: The purpose of this code is to get the actual vertical axis</span>
        <span class="c1"># passed by `coords`. It can differ from the default `axis.vertical` in</span>
        <span class="c1"># `encoding`. The set intersection cannot be used.</span>
        <span class="n">vert_axis</span><span class="p">:</span> <span class="n">axis</span><span class="o">.</span><span class="n">vertical</span>
        <span class="k">for</span> <span class="n">axis_</span> <span class="ow">in</span> <span class="n">new_coords</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">axis_</span> <span class="o">==</span> <span class="n">axis</span><span class="o">.</span><span class="n">vertical</span><span class="p">:</span>
                <span class="n">vert_axis</span> <span class="o">=</span> <span class="n">axis_</span>
                <span class="k">break</span>
        <span class="n">vert</span> <span class="o">=</span> <span class="n">dset</span><span class="p">[</span><span class="n">vert_axis</span><span class="p">]</span>
        <span class="n">vert_mag</span><span class="p">,</span> <span class="n">vert_units</span> <span class="o">=</span> <span class="n">vert</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="n">vert</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span>
        <span class="n">n_profiles</span> <span class="o">=</span> <span class="n">vert_mag</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_profiles</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">elevation</span><span class="p">))</span>
        <span class="n">new_vert_mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">vert_mag</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
        <span class="c1"># TODO: Try to implement this in a more efficient way.</span>
        <span class="n">level_indices</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">profile_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_profiles</span><span class="p">):</span>
            <span class="n">level_idx</span> <span class="o">=</span> <span class="n">get_indexer</span><span class="p">(</span>
                <span class="p">[</span><span class="n">vert_mag</span><span class="p">[</span><span class="n">profile_idx</span><span class="p">,</span> <span class="p">:]],</span>
                <span class="p">[</span><span class="n">get_magnitude</span><span class="p">(</span><span class="n">elevation</span><span class="p">,</span> <span class="n">vert_units</span><span class="p">)],</span>
                <span class="n">return_all</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span>
                <span class="n">tolerance</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>
            <span class="p">)</span>
            <span class="n">level_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">level_idx</span><span class="p">)</span>
            <span class="n">new_vert_mag</span><span class="p">[</span><span class="n">profile_idx</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">vert_mag</span><span class="p">[</span><span class="n">profile_idx</span><span class="p">,</span> <span class="n">level_idx</span><span class="p">]</span>
        <span class="n">new_coords</span><span class="p">[</span><span class="n">vert_axis</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span>
            <span class="n">dims</span><span class="o">=</span><span class="n">vert</span><span class="o">.</span><span class="n">dims</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">new_vert_mag</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="n">vert</span><span class="o">.</span><span class="n">attrs</span>
        <span class="p">)</span>

        <span class="n">new_data_vars</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">darr</span> <span class="ow">in</span> <span class="n">dset</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">data_mag</span> <span class="o">=</span> <span class="n">darr</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
            <span class="n">new_data_mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">data_mag</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
            <span class="c1"># TODO: Try to implement this in a more efficient way.</span>
            <span class="k">for</span> <span class="n">profile_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_profiles</span><span class="p">):</span>
                <span class="n">level_idx</span> <span class="o">=</span> <span class="n">level_indices</span><span class="p">[</span><span class="n">profile_idx</span><span class="p">]</span>
                <span class="n">new_data_mag</span><span class="p">[</span><span class="n">profile_idx</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">data_mag</span><span class="p">[</span><span class="n">profile_idx</span><span class="p">,</span> <span class="n">level_idx</span><span class="p">]</span>
            <span class="n">new_data_vars</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="n">new_data_mag</span><span class="p">,</span>
                <span class="n">dims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_DIMS_</span><span class="p">,</span>
                <span class="n">coords</span><span class="o">=</span><span class="n">new_coords</span><span class="p">,</span>
                <span class="n">attrs</span><span class="o">=</span><span class="n">darr</span><span class="o">.</span><span class="n">attrs</span>
            <span class="p">)</span>

        <span class="n">new_dset</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span>
            <span class="n">data_vars</span><span class="o">=</span><span class="n">new_data_vars</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="n">new_coords</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="n">dset</span><span class="o">.</span><span class="n">attrs</span>
        <span class="p">)</span>
        <span class="n">feature</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_from_xarray_dataset</span><span class="p">(</span><span class="n">new_dset</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">feature</span>

    <span class="k">def</span> <span class="nf">as_points</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PointsFeature</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return points representation of the data and coordinates.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        PointsFeature</span>
<span class="sd">            Points feature with the same data and coordinates.</span>
<span class="sd">        &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="geokube.core.feature.ProfilesFeature.number_of_levels" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">number_of_levels</span><span class="p">:</span> <span class="nb">int</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns the number of levels in a domain or field.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="geokube.core.feature.ProfilesFeature.number_of_profiles" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">number_of_profiles</span><span class="p">:</span> <span class="nb">int</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns the number of profiles in a domain or field.</p>
  </div>

</div>




<div class="doc doc-object doc-function">



<h3 id="geokube.core.feature.ProfilesFeature.as_points" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">as_points</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Return points representation of the data and coordinates.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="geokube.core.feature.PointsFeature" href="#geokube.core.feature.PointsFeature">PointsFeature</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Points feature with the same data and coordinates.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>geokube/core/feature.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">as_points</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PointsFeature</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return points representation of the data and coordinates.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    PointsFeature</span>
<span class="sd">        Points feature with the same data and coordinates.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="geokube.core.feature.ProfilesFeature.bounding_box" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">bounding_box</span><span class="p">(</span><span class="n">south</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">north</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">west</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">east</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Return a subset defined with a bounding box.</p>
<p>This operation extracts a subset of values within a bounding
box specified with the parameters north, south, east, and west.
It is unit-aware, which means that the units do not need to be
converted before passing to the method.  If a quantity is
passed, the units are automatically adjusted.  If just a number
is provided, it is assumed that the units are the same as the
corresponding coordinate.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>south</code></td>
          <td>
                <code>number or <span title="geokube.core.quantity">quantity</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Horizontal bounds.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>north</code></td>
          <td>
                <code>number or <span title="geokube.core.quantity">quantity</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Horizontal bounds.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>west</code></td>
          <td>
                <code>number or <span title="geokube.core.quantity">quantity</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Horizontal bounds.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>east</code></td>
          <td>
                <code>number or <span title="geokube.core.quantity">quantity</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Horizontal bounds.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>bottom</code></td>
          <td>
                <code>number or <span title="geokube.core.quantity">quantity</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Vertical bounds.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>top</code></td>
          <td>
                <code>number or <span title="geokube.core.quantity">quantity</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Vertical bounds.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>feature</code></td>          <td>
                <code>caller type</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A feature, domain, or field obtained after subsetting the
caller.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>geokube/core/feature.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">bounding_box</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">south</span><span class="p">:</span> <span class="n">Number</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">north</span><span class="p">:</span> <span class="n">Number</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">west</span><span class="p">:</span> <span class="n">Number</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">east</span><span class="p">:</span> <span class="n">Number</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">bottom</span><span class="p">:</span> <span class="n">Number</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">top</span><span class="p">:</span> <span class="n">Number</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a subset defined with a bounding box.</span>

<span class="sd">    This operation extracts a subset of values within a bounding</span>
<span class="sd">    box specified with the parameters north, south, east, and west.</span>
<span class="sd">    It is unit-aware, which means that the units do not need to be</span>
<span class="sd">    converted before passing to the method.  If a quantity is</span>
<span class="sd">    passed, the units are automatically adjusted.  If just a number</span>
<span class="sd">    is provided, it is assumed that the units are the same as the</span>
<span class="sd">    corresponding coordinate.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    south, north, west, east : number or quantity, optional</span>
<span class="sd">        Horizontal bounds.</span>
<span class="sd">    bottom, top : number or quantity, optional</span>
<span class="sd">        Vertical bounds.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    feature : caller type</span>
<span class="sd">        A feature, domain, or field obtained after subsetting the</span>
<span class="sd">        caller.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">h_idx</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">latitude</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="n">south</span><span class="p">,</span> <span class="n">north</span><span class="p">),</span>
        <span class="n">axis</span><span class="o">.</span><span class="n">longitude</span><span class="p">:</span> <span class="nb">slice</span><span class="p">(</span><span class="n">west</span><span class="p">,</span> <span class="n">east</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="n">feature</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">h_idx</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">bottom</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">top</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
        <span class="c1"># TODO: Try to move this functionality to</span>
        <span class="c1"># `indexes.TwoDimHorPointsIndex.sel`.</span>
        <span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;&#39;bounding_box&#39; loads in memory and makes a copy of the data &quot;</span>
            <span class="s2">&quot;and vertical coordinate when &#39;bottom&#39; or &#39;top&#39; is not &#39;None&#39;&quot;</span>
        <span class="p">)</span>
        <span class="c1"># TODO: Make `vert_axis` the actual vertical axis from the</span>
        <span class="c1"># coordinates.</span>
        <span class="n">v_slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">bottom</span><span class="p">,</span> <span class="n">top</span><span class="p">)</span>
        <span class="n">v_idx</span> <span class="o">=</span> <span class="p">{</span><span class="n">axis</span><span class="o">.</span><span class="n">vertical</span><span class="p">:</span> <span class="n">v_slice</span><span class="p">}</span>
        <span class="n">new_data</span> <span class="o">=</span> <span class="n">feature</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">v_idx</span><span class="p">)</span><span class="o">.</span><span class="n">_dset</span>
        <span class="n">new_data</span> <span class="o">=</span> <span class="n">new_data</span><span class="o">.</span><span class="n">drop_indexes</span><span class="p">(</span>
            <span class="n">coord_names</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">new_data</span><span class="o">.</span><span class="n">xindexes</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="p">)</span>
        <span class="n">vert</span> <span class="o">=</span> <span class="n">new_data</span><span class="p">[</span><span class="n">axis</span><span class="o">.</span><span class="n">vertical</span><span class="p">]</span>
        <span class="n">vert_mag</span><span class="p">,</span> <span class="n">vert_units</span> <span class="o">=</span> <span class="n">vert</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="n">vert</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">get_indexer</span><span class="p">(</span>
            <span class="p">[</span><span class="n">vert_mag</span><span class="p">],</span> <span class="p">[</span><span class="n">get_magnitude</span><span class="p">(</span><span class="n">v_slice</span><span class="p">,</span> <span class="n">vert_units</span><span class="p">)]</span>
        <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">masked_vert</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">vert_mag</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">new_data</span><span class="p">[</span><span class="n">axis</span><span class="o">.</span><span class="n">vertical</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[:]</span> <span class="o">=</span> <span class="n">masked_vert</span>
        <span class="k">for</span> <span class="n">darr</span> <span class="ow">in</span> <span class="n">new_data</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">mag</span> <span class="o">=</span> <span class="n">darr</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
            <span class="n">masked_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">mag</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
            <span class="n">darr</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()[:]</span> <span class="o">=</span> <span class="n">masked_data</span>
        <span class="n">feature</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_from_xarray_dataset</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">feature</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="geokube.core.feature.ProfilesFeature.nearest_vertical" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">nearest_vertical</span><span class="p">(</span><span class="n">elevation</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Return the nearest vertical locations from the domain.</p>
<p>This operation is unit-aware, which means that the units do not
need to be converted before passing to the method.  If a
quantity is passed, the units are automatically adjusted.  If
just a number or array is provided, it is assumed that the units
are the same as the corresponding coordinate.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>elevation</code></td>
          <td>
                <code>array_like or <span title="geokube.core.quantity">quantity</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Vertical coordinates for subsetting.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>caller type</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>A feature, domain, or field with the the nearest vertical
locations to the elevation.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>geokube/core/feature.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">nearest_vertical</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">elevation</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span> <span class="o">|</span> <span class="n">pint</span><span class="o">.</span><span class="n">Quantity</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the nearest vertical locations from the domain.</span>

<span class="sd">    This operation is unit-aware, which means that the units do not</span>
<span class="sd">    need to be converted before passing to the method.  If a</span>
<span class="sd">    quantity is passed, the units are automatically adjusted.  If</span>
<span class="sd">    just a number or array is provided, it is assumed that the units</span>
<span class="sd">    are the same as the corresponding coordinate.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    elevation : array_like or quantity</span>
<span class="sd">        Vertical coordinates for subsetting.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    caller type</span>
<span class="sd">        A feature, domain, or field with the the nearest vertical</span>
<span class="sd">        locations to the elevation.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO: Try to move this functionality to</span>
    <span class="c1"># `indexes.TwoDimHorPointsIndex.sel`.</span>
    <span class="n">dset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dset</span>
    <span class="n">new_coords</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">axis_</span><span class="p">:</span> <span class="n">coord</span><span class="o">.</span><span class="n">variable</span> <span class="k">for</span> <span class="n">axis_</span><span class="p">,</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">dset</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="c1"># NOTE: The purpose of this code is to get the actual vertical axis</span>
    <span class="c1"># passed by `coords`. It can differ from the default `axis.vertical` in</span>
    <span class="c1"># `encoding`. The set intersection cannot be used.</span>
    <span class="n">vert_axis</span><span class="p">:</span> <span class="n">axis</span><span class="o">.</span><span class="n">vertical</span>
    <span class="k">for</span> <span class="n">axis_</span> <span class="ow">in</span> <span class="n">new_coords</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">axis_</span> <span class="o">==</span> <span class="n">axis</span><span class="o">.</span><span class="n">vertical</span><span class="p">:</span>
            <span class="n">vert_axis</span> <span class="o">=</span> <span class="n">axis_</span>
            <span class="k">break</span>
    <span class="n">vert</span> <span class="o">=</span> <span class="n">dset</span><span class="p">[</span><span class="n">vert_axis</span><span class="p">]</span>
    <span class="n">vert_mag</span><span class="p">,</span> <span class="n">vert_units</span> <span class="o">=</span> <span class="n">vert</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span> <span class="n">vert</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span>
    <span class="n">n_profiles</span> <span class="o">=</span> <span class="n">vert_mag</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_profiles</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">elevation</span><span class="p">))</span>
    <span class="n">new_vert_mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">vert_mag</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
    <span class="c1"># TODO: Try to implement this in a more efficient way.</span>
    <span class="n">level_indices</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">profile_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_profiles</span><span class="p">):</span>
        <span class="n">level_idx</span> <span class="o">=</span> <span class="n">get_indexer</span><span class="p">(</span>
            <span class="p">[</span><span class="n">vert_mag</span><span class="p">[</span><span class="n">profile_idx</span><span class="p">,</span> <span class="p">:]],</span>
            <span class="p">[</span><span class="n">get_magnitude</span><span class="p">(</span><span class="n">elevation</span><span class="p">,</span> <span class="n">vert_units</span><span class="p">)],</span>
            <span class="n">return_all</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span>
            <span class="n">tolerance</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span>
        <span class="p">)</span>
        <span class="n">level_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">level_idx</span><span class="p">)</span>
        <span class="n">new_vert_mag</span><span class="p">[</span><span class="n">profile_idx</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">vert_mag</span><span class="p">[</span><span class="n">profile_idx</span><span class="p">,</span> <span class="n">level_idx</span><span class="p">]</span>
    <span class="n">new_coords</span><span class="p">[</span><span class="n">vert_axis</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span>
        <span class="n">dims</span><span class="o">=</span><span class="n">vert</span><span class="o">.</span><span class="n">dims</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">new_vert_mag</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="n">vert</span><span class="o">.</span><span class="n">attrs</span>
    <span class="p">)</span>

    <span class="n">new_data_vars</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">darr</span> <span class="ow">in</span> <span class="n">dset</span><span class="o">.</span><span class="n">data_vars</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">data_mag</span> <span class="o">=</span> <span class="n">darr</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
        <span class="n">new_data_mag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">data_mag</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
        <span class="c1"># TODO: Try to implement this in a more efficient way.</span>
        <span class="k">for</span> <span class="n">profile_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_profiles</span><span class="p">):</span>
            <span class="n">level_idx</span> <span class="o">=</span> <span class="n">level_indices</span><span class="p">[</span><span class="n">profile_idx</span><span class="p">]</span>
            <span class="n">new_data_mag</span><span class="p">[</span><span class="n">profile_idx</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">data_mag</span><span class="p">[</span><span class="n">profile_idx</span><span class="p">,</span> <span class="n">level_idx</span><span class="p">]</span>
        <span class="n">new_data_vars</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">new_data_mag</span><span class="p">,</span>
            <span class="n">dims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_DIMS_</span><span class="p">,</span>
            <span class="n">coords</span><span class="o">=</span><span class="n">new_coords</span><span class="p">,</span>
            <span class="n">attrs</span><span class="o">=</span><span class="n">darr</span><span class="o">.</span><span class="n">attrs</span>
        <span class="p">)</span>

    <span class="n">new_dset</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span>
        <span class="n">data_vars</span><span class="o">=</span><span class="n">new_data_vars</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="n">new_coords</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="n">dset</span><span class="o">.</span><span class="n">attrs</span>
    <span class="p">)</span>
    <span class="n">feature</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_from_xarray_dataset</span><span class="p">(</span><span class="n">new_dset</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">feature</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>




  </div>

  </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": ["search.suggest", "search.highlight", "content.tooltips", "content.code.annotate", "content.code.copy", "content.code.select"], "search": "assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.e1c3ead8.min.js"></script>
      
    
  </body>
</html>